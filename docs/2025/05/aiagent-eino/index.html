<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
        [AI Agent] Eino - UnderTheHood
      </title>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    
    <meta name="theme-color" content="#000000" />
    
    <meta http-equiv="window-target" content="_top" />
    
    
    <meta name="description" content=" ÂéüÊñáÊàëËÆ∞ÂΩïÂú®È£û‰π¶ÊñáÊ°£: https://c6t4wbgxht.feishu.cn/docx/WLmndFiDgokHVvxoBkZczB67n3b Êã∑Ë¥ùÊó∂‰ºöÊúâÊ†ºÂºèÈóÆÈ¢ò
Eino ÊòØÂ≠óËäÇÂºÄÊ∫êÁöÑgolangÂÜôÁöÑ ai agent ÂºÄÂèëÊ°ÜÊû∂ÔºåÁ±ª‰ººpythonÂÜôÁöÑlangchain„ÄÅllamaindex„ÄÇ Ai agent Êô∫ËÉΩ‰ΩìÔºåÂèØ‰ª•ÁêÜËß£‰∏∫ÊòØ‰∏ÄÁßçÂÆåÊàê ‚ÄúÊÑüÁü•„ÄÅÊÄùËÄÉ„ÄÅÊâßË°å‚Äù ÁöÑÁ®ãÂ∫èÔºåÂÖ∂‰∏≠ÊÄùËÄÉÁöÑÈÉ®ÂàÜÂÄüÂä©Â§ßÊ®°ÂûãÂÆåÊàê Â§ßÊ®°ÂûãÊúâ‰∏âÁßç‰∏ªË¶ÅÁöÑÂ∫îÁî®Ê®°ÂºèÔºö
" />
    <meta name="generator" content="Hugo 0.145.0 with theme pure" />
    <title>[AI Agent] Eino - UnderTheHood</title>
    
    
    <link rel="stylesheet" href="https://wymli.github.io/css/style.min.31c841d028bbb1b4f57eadc51e8f652fb1d4f783171c15f4f5de039708e133b3.css">
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css" async>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
    <meta property="og:url" content="https://wymli.github.io/2025/05/aiagent-eino/">
  <meta property="og:site_name" content="UnderTheHood">
  <meta property="og:title" content="[AI Agent] Eino">
  <meta property="og:description" content="ÂéüÊñáÊàëËÆ∞ÂΩïÂú®È£û‰π¶ÊñáÊ°£: https://c6t4wbgxht.feishu.cn/docx/WLmndFiDgokHVvxoBkZczB67n3b Êã∑Ë¥ùÊó∂‰ºöÊúâÊ†ºÂºèÈóÆÈ¢ò
Eino ÊòØÂ≠óËäÇÂºÄÊ∫êÁöÑgolangÂÜôÁöÑ ai agent ÂºÄÂèëÊ°ÜÊû∂ÔºåÁ±ª‰ººpythonÂÜôÁöÑlangchain„ÄÅllamaindex„ÄÇ Ai agent Êô∫ËÉΩ‰ΩìÔºåÂèØ‰ª•ÁêÜËß£‰∏∫ÊòØ‰∏ÄÁßçÂÆåÊàê ‚ÄúÊÑüÁü•„ÄÅÊÄùËÄÉ„ÄÅÊâßË°å‚Äù ÁöÑÁ®ãÂ∫èÔºåÂÖ∂‰∏≠ÊÄùËÄÉÁöÑÈÉ®ÂàÜÂÄüÂä©Â§ßÊ®°ÂûãÂÆåÊàê Â§ßÊ®°ÂûãÊúâ‰∏âÁßç‰∏ªË¶ÅÁöÑÂ∫îÁî®Ê®°ÂºèÔºö">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-16T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-05-16T00:00:00+00:00">
    <meta property="article:tag" content="Ai Agent">
    <meta property="article:tag" content="Eino">

  <meta itemprop="name" content="[AI Agent] Eino">
  <meta itemprop="description" content="ÂéüÊñáÊàëËÆ∞ÂΩïÂú®È£û‰π¶ÊñáÊ°£: https://c6t4wbgxht.feishu.cn/docx/WLmndFiDgokHVvxoBkZczB67n3b Êã∑Ë¥ùÊó∂‰ºöÊúâÊ†ºÂºèÈóÆÈ¢ò
Eino ÊòØÂ≠óËäÇÂºÄÊ∫êÁöÑgolangÂÜôÁöÑ ai agent ÂºÄÂèëÊ°ÜÊû∂ÔºåÁ±ª‰ººpythonÂÜôÁöÑlangchain„ÄÅllamaindex„ÄÇ Ai agent Êô∫ËÉΩ‰ΩìÔºåÂèØ‰ª•ÁêÜËß£‰∏∫ÊòØ‰∏ÄÁßçÂÆåÊàê ‚ÄúÊÑüÁü•„ÄÅÊÄùËÄÉ„ÄÅÊâßË°å‚Äù ÁöÑÁ®ãÂ∫èÔºåÂÖ∂‰∏≠ÊÄùËÄÉÁöÑÈÉ®ÂàÜÂÄüÂä©Â§ßÊ®°ÂûãÂÆåÊàê Â§ßÊ®°ÂûãÊúâ‰∏âÁßç‰∏ªË¶ÅÁöÑÂ∫îÁî®Ê®°ÂºèÔºö">
  <meta itemprop="datePublished" content="2025-05-16T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-05-16T00:00:00+00:00">
  <meta itemprop="wordCount" content="5531">
  <meta itemprop="keywords" content="Ai Agent,Eino">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[AI Agent] Eino">
  <meta name="twitter:description" content="ÂéüÊñáÊàëËÆ∞ÂΩïÂú®È£û‰π¶ÊñáÊ°£: https://c6t4wbgxht.feishu.cn/docx/WLmndFiDgokHVvxoBkZczB67n3b Êã∑Ë¥ùÊó∂‰ºöÊúâÊ†ºÂºèÈóÆÈ¢ò
Eino ÊòØÂ≠óËäÇÂºÄÊ∫êÁöÑgolangÂÜôÁöÑ ai agent ÂºÄÂèëÊ°ÜÊû∂ÔºåÁ±ª‰ººpythonÂÜôÁöÑlangchain„ÄÅllamaindex„ÄÇ Ai agent Êô∫ËÉΩ‰ΩìÔºåÂèØ‰ª•ÁêÜËß£‰∏∫ÊòØ‰∏ÄÁßçÂÆåÊàê ‚ÄúÊÑüÁü•„ÄÅÊÄùËÄÉ„ÄÅÊâßË°å‚Äù ÁöÑÁ®ãÂ∫èÔºåÂÖ∂‰∏≠ÊÄùËÄÉÁöÑÈÉ®ÂàÜÂÄüÂä©Â§ßÊ®°ÂûãÂÆåÊàê Â§ßÊ®°ÂûãÊúâ‰∏âÁßç‰∏ªË¶ÅÁöÑÂ∫îÁî®Ê®°ÂºèÔºö">

    <!--[if lte IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
      <![endif]-->

    <!--[if lt IE 9]>
        <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
      <![endif]-->
  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="https://github.com/wymli" target="_blank">
            <img class="img-circle img-rotate" src="https://wymli.github.io/me.jpg" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">Li Weiming</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md">wymli@sysu.cse</h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Guangzhou, China</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="Type something..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">√ó</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Archives</span>
                </a>
            </li>
            <li class="menu-item menu-item-categories">
                <a href="/categories/">
                    <i class="icon icon-folder"></i>
                  <span class="menu-title">Categories</span>
                </a>
            </li>
            <li class="menu-item menu-item-tags">
                <a href="/tags/">
                    <i class="icon icon-tags"></i>
                  <span class="menu-title">Tags</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content"><p>üíïüòéüê±‚Äçüë§üê±‚Äçüèç‚ú®</p>
            </div>
        </div>
    </div>
</div>

      <div class="widget">
    <h3 class="widget-title"> Tags</h3>
    <div id="tag-cloud-list" class="widget-body">
            
            
            <a href="https://wymli.github.io/tags/ai-agent/" class="tag-list-link" rel="1">ai agent<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/airflow/" class="tag-list-link" rel="1">airflow<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/algorithm/" class="tag-list-link" rel="1">algorithm<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/arch/" class="tag-list-link" rel="1">arch<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/atomic/" class="tag-list-link" rel="1">atomic<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/bigdata/" class="tag-list-link" rel="3">bigdata<span
               class="tag-list-count">3</span></a>
            
            
            <a href="https://wymli.github.io/tags/bytedance/" class="tag-list-link" rel="1">bytedance<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/c/" class="tag-list-link" rel="2">c<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/cache/" class="tag-list-link" rel="1">cache<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/cli/" class="tag-list-link" rel="2">cli<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/concurrency/" class="tag-list-link" rel="1">concurrency<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/container/" class="tag-list-link" rel="6">container<span
               class="tag-list-count">6</span></a>
            
            
            <a href="https://wymli.github.io/tags/containerd/" class="tag-list-link" rel="1">containerd<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/database/" class="tag-list-link" rel="4">database<span
               class="tag-list-count">4</span></a>
            
            
            <a href="https://wymli.github.io/tags/datamining/" class="tag-list-link" rel="1">datamining<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/datastructure/" class="tag-list-link" rel="1">datastructure<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/db/" class="tag-list-link" rel="1">db<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/deploy/" class="tag-list-link" rel="1">deploy<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/designpattern/" class="tag-list-link" rel="1">designpattern<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/distribute/" class="tag-list-link" rel="1">distribute<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/eino/" class="tag-list-link" rel="1">eino<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/event-stream/" class="tag-list-link" rel="1">event-stream<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/golang/" class="tag-list-link" rel="20">golang<span
               class="tag-list-count">20</span></a>
            
            
            <a href="https://wymli.github.io/tags/http/" class="tag-list-link" rel="2">http<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/interview/" class="tag-list-link" rel="3">interview<span
               class="tag-list-count">3</span></a>
            
            
            <a href="https://wymli.github.io/tags/kafka/" class="tag-list-link" rel="5">kafka<span
               class="tag-list-count">5</span></a>
            
            
            <a href="https://wymli.github.io/tags/lsh/" class="tag-list-link" rel="1">lsh<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/oauth2/" class="tag-list-link" rel="1">oauth2<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/oci/" class="tag-list-link" rel="5">oci<span
               class="tag-list-count">5</span></a>
            
            
            <a href="https://wymli.github.io/tags/other/" class="tag-list-link" rel="2">other<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/overlayfs/" class="tag-list-link" rel="1">overlayfs<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/proc/" class="tag-list-link" rel="1">proc<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/redis/" class="tag-list-link" rel="1">redis<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/rpc/" class="tag-list-link" rel="4">rpc<span
               class="tag-list-count">4</span></a>
            
            
            <a href="https://wymli.github.io/tags/runc/" class="tag-list-link" rel="2">runc<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/script/" class="tag-list-link" rel="1">script<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/server/" class="tag-list-link" rel="3">server<span
               class="tag-list-count">3</span></a>
            
            
            <a href="https://wymli.github.io/tags/socket/" class="tag-list-link" rel="1">socket<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/sys/" class="tag-list-link" rel="2">sys<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/taskqueue/" class="tag-list-link" rel="1">taskqueue<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/temporal/" class="tag-list-link" rel="1">temporal<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/tensorflow/" class="tag-list-link" rel="1">tensorflow<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/todo/" class="tag-list-link" rel="1">todo<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/underthehood/" class="tag-list-link" rel="1">underthehood<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/ut/" class="tag-list-link" rel="1">ut<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/vue/" class="tag-list-link" rel="2">vue<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/workflow/" class="tag-list-link" rel="2">workflow<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/wsl/" class="tag-list-link" rel="1">wsl<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/zookeeper/" class="tag-list-link" rel="1">zookeeper<span
               class="tag-list-count">1</span></a>
            
    </div>
<script>
document.onreadystatechange = () => {
  if (document.readyState === 'complete') {
    tagCloud('#tag-cloud-list a',  8 ,  20 );
  }
};

function tagCloud(where, min, max) {
  let iMax = 0;
  let iMin = 0;
  $(where).each(function() {
    let weight = Number($(this).attr("rel"));
    if(iMax < weight) iMax = weight;
    if(iMin > weight || iMin == 0) iMin = weight;
  });
  let step = (max - min)/(iMax - iMin);
  $(where).each(function() {
    let weight = $(this).attr("rel") - iMin;
    $(this).css({"font-size": min + (weight * step) + 'px'});
  });
};
</script>
</div>

      <div class="widget">
    <h3 class="widget-title"> Categories</h3>
    <div class="widget-body">
        <ul class="category-list">
            <li class="category-list-item"><a href="https://wymli.github.io/categories/ai-agent/" class="category-list-link">ai agent</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/algorithm/" class="category-list-link">algorithm</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/arch/" class="category-list-link">arch</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/atomic/" class="category-list-link">atomic</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/bigdata/" class="category-list-link">bigdata</a><span class="category-list-count">3</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/bytedance/" class="category-list-link">bytedance</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/c/" class="category-list-link">c</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/cache/" class="category-list-link">cache</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/cli/" class="category-list-link">cli</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/concurrency/" class="category-list-link">concurrency</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/configcenter/" class="category-list-link">configcenter</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/container/" class="category-list-link">container</a><span class="category-list-count">6</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/database/" class="category-list-link">database</a><span class="category-list-count">4</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/datamining/" class="category-list-link">datamining</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/datastructure/" class="category-list-link">datastructure</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/db/" class="category-list-link">db</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/deploy/" class="category-list-link">deploy</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/distribute/" class="category-list-link">distribute</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/golang/" class="category-list-link">golang</a><span class="category-list-count">20</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/http/" class="category-list-link">http</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/install/" class="category-list-link">install</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/interview/" class="category-list-link">interview</a><span class="category-list-count">3</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/linux/" class="category-list-link">linux</a><span class="category-list-count">3</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/messagequeue/" class="category-list-link">messagequeue</a><span class="category-list-count">5</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/os/" class="category-list-link">os</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/os-memory/" class="category-list-link">os-memory</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/other/" class="category-list-link">other</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/protocal/" class="category-list-link">protocal</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/protocol/" class="category-list-link">protocol</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/redis/" class="category-list-link">redis</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/rpc/" class="category-list-link">rpc</a><span class="category-list-count">4</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/script/" class="category-list-link">script</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/sys/" class="category-list-link">sys</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/taskqueue/" class="category-list-link">taskqueue</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/tensorflow/" class="category-list-link">tensorflow</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/todo/" class="category-list-link">todo</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/underthehood/" class="category-list-link">underthehood</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/vue/" class="category-list-link">vue</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/workflow/" class="category-list-link">workflow</a><span class="category-list-count">2</span></li>
        </ul>
    </div>
</div>
      <div class="widget">
    <h3 class="widget-title"> Tags</h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/ai-agent/" class="tag-list-link">ai agent</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/airflow/" class="tag-list-link">airflow</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/algorithm/" class="tag-list-link">algorithm</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/arch/" class="tag-list-link">arch</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/atomic/" class="tag-list-link">atomic</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/bigdata/" class="tag-list-link">bigdata</a><span
                    class="tag-list-count">3</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/bytedance/" class="tag-list-link">bytedance</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/c/" class="tag-list-link">c</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/cache/" class="tag-list-link">cache</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/cli/" class="tag-list-link">cli</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/concurrency/" class="tag-list-link">concurrency</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/container/" class="tag-list-link">container</a><span
                    class="tag-list-count">6</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/containerd/" class="tag-list-link">containerd</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/database/" class="tag-list-link">database</a><span
                    class="tag-list-count">4</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/datamining/" class="tag-list-link">datamining</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/datastructure/" class="tag-list-link">datastructure</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/db/" class="tag-list-link">db</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/deploy/" class="tag-list-link">deploy</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/designpattern/" class="tag-list-link">designpattern</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/distribute/" class="tag-list-link">distribute</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/eino/" class="tag-list-link">eino</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/event-stream/" class="tag-list-link">event-stream</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/golang/" class="tag-list-link">golang</a><span
                    class="tag-list-count">20</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/http/" class="tag-list-link">http</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/interview/" class="tag-list-link">interview</a><span
                    class="tag-list-count">3</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/kafka/" class="tag-list-link">kafka</a><span
                    class="tag-list-count">5</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/lsh/" class="tag-list-link">lsh</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/oauth2/" class="tag-list-link">oauth2</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/oci/" class="tag-list-link">oci</a><span
                    class="tag-list-count">5</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/other/" class="tag-list-link">other</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/overlayfs/" class="tag-list-link">overlayfs</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/proc/" class="tag-list-link">proc</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/redis/" class="tag-list-link">redis</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/rpc/" class="tag-list-link">rpc</a><span
                    class="tag-list-count">4</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/runc/" class="tag-list-link">runc</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/script/" class="tag-list-link">script</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/server/" class="tag-list-link">server</a><span
                    class="tag-list-count">3</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/socket/" class="tag-list-link">socket</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/sys/" class="tag-list-link">sys</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/taskqueue/" class="tag-list-link">taskqueue</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/temporal/" class="tag-list-link">temporal</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/tensorflow/" class="tag-list-link">tensorflow</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/todo/" class="tag-list-link">todo</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/underthehood/" class="tag-list-link">underthehood</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/ut/" class="tag-list-link">ut</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/vue/" class="tag-list-link">vue</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/workflow/" class="tag-list-link">workflow</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/wsl/" class="tag-list-link">wsl</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/zookeeper/" class="tag-list-link">zookeeper</a><span
                    class="tag-list-count">1</span></li>
            
        </ul>

    </div>
</div>
      
<div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2021/04/a2todo-todo-list/" class="title">TodoList</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-04-08 00:00:00 &#43;0000 UTC" itemprop="datePublished">2021-04-08</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2021/04/a1underthehood-underthehood/" class="title">[UnderTheHood] Âü∫Á°Ä-ÈáçË¶Å-Áü•ËØÜ-ÊïôÊó®-Ê†ºË®Ä-Ëùâ</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-04-10 00:00:00 &#43;0000 UTC" itemprop="datePublished">2021-04-10</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2025/05/aiagent-eino/" class="title">[AI Agent] Eino</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2025-05-16 00:00:00 &#43;0000 UTC" itemprop="datePublished">2025-05-16</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2025/05/db-mutex/" class="title">[DB] ‰∫ãÂä°ÈöîÁ¶ª‰∏éÈîÅ</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2025-05-14 00:00:00 &#43;0000 UTC" itemprop="datePublished">2025-05-14</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2025/05/go-gmp/" class="title">[Go] GMP</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2025-05-11 00:00:00 &#43;0000 UTC" itemprop="datePublished">2025-05-11</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>
  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">Catalogue</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>
<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h1 itemprop="name">
  <a
    class="article-title"
    href="/2025/05/aiagent-eino/"
    >[AI Agent] Eino</a
  >
</h1>

      <div class="article-meta">
        
<span class="article-date">
  <i class="icon icon-calendar-check"></i>&nbsp;
<a href="https://wymli.github.io/2025/05/aiagent-eino/" class="article-date">
  <time datetime="2025-05-16 00:00:00 &#43;0000 UTC" itemprop="datePublished">2025-05-16</time>
</a>
</span>
<span class="article-category">
  <i class="icon icon-folder"></i>&nbsp;
  <a class="article-category-link" href="/categories/ai-agent/"> ai agent </a>
</span>  
  <span class="article-tag">
    <i class="icon icon-tags"></i>&nbsp;
    <a class="article-tag-link" href="/tags/ai-agent/"> ai agent </a>
    <a class="article-tag-link" href="/tags/eino/"> eino </a>
  </span>

		<span class="post-wordcount hidden-xs" itemprop="wordCount">Word Count: 5531 words</span>
		<span class="post-readcount hidden-xs" itemprop="timeRequired">Read Time: 12 minutes </span>
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <blockquote>
<p>ÂéüÊñáÊàëËÆ∞ÂΩïÂú®È£û‰π¶ÊñáÊ°£: <a href="https://c6t4wbgxht.feishu.cn/docx/WLmndFiDgokHVvxoBkZczB67n3b">https://c6t4wbgxht.feishu.cn/docx/WLmndFiDgokHVvxoBkZczB67n3b</a>
Êã∑Ë¥ùÊó∂‰ºöÊúâÊ†ºÂºèÈóÆÈ¢ò</p></blockquote>
<p>Eino ÊòØÂ≠óËäÇÂºÄÊ∫êÁöÑgolangÂÜôÁöÑ ai agent ÂºÄÂèëÊ°ÜÊû∂ÔºåÁ±ª‰ººpythonÂÜôÁöÑlangchain„ÄÅllamaindex„ÄÇ
Ai agent Êô∫ËÉΩ‰ΩìÔºåÂèØ‰ª•ÁêÜËß£‰∏∫ÊòØ‰∏ÄÁßçÂÆåÊàê ‚ÄúÊÑüÁü•„ÄÅÊÄùËÄÉ„ÄÅÊâßË°å‚Äù ÁöÑÁ®ãÂ∫èÔºåÂÖ∂‰∏≠ÊÄùËÄÉÁöÑÈÉ®ÂàÜÂÄüÂä©Â§ßÊ®°ÂûãÂÆåÊàê
Â§ßÊ®°ÂûãÊúâ‰∏âÁßç‰∏ªË¶ÅÁöÑÂ∫îÁî®Ê®°ÂºèÔºö</p>
<ol>
<li>Áõ¥Êé•ÂØπËØù</li>
<li>Áü•ËØÜÂ∫ì RAG</li>
<li>AI Agent Â∑•ÂÖ∑Ë∞ÉÁî®</li>
</ol>
<p>ÈíàÂØπ‰∏âÁßç‰∏ªË¶ÅÂ∫îÁî®Ê®°ÂºèÔºåEinoÊúâÂ¶Ç‰∏ãÂá†ÁßçÁªÑ‰ª∂ÊäΩË±°Ôºö</p>
<ol>
<li>ÂØπËØùÔºö</li>
<li>ChatTemplate</li>
<li>ChatModel</li>
<li>Áü•ËØÜÂ∫ìÔºö</li>
<li>ÊñáÊú¨Âä†ËΩΩÂíåÂ§ÑÁêÜÔºöDocument.Loader, Document.Transformer</li>
<li>ÊñáÊú¨ÁºñÁ†ÅÔºöEmbedding ÔºàË∞ÉÁî®Â§ßÊ®°ÂûãÁºñÁ†ÅÔºâ</li>
<li>ÂêëÈáèÂ≠òÂÇ®ÔºöIndexer</li>
<li>Âè¨ÂõûÔºöRetriever</li>
<li>AI AgentÂÜ≥Á≠ñÊâßË°åÔºö</li>
<li>ToolsNode</li>
<li>Ëá™ÂÆö‰πâÁªÑ‰ª∂Ôºö</li>
<li>LambdaÔºöËá™Â∑±ÂÆûÁé∞ÂÖ∑‰ΩìÁöÑÈÄªËæë</li>
</ol>
<h1 id="quick-start">Quick Start</h1>
<h2 id="chat">Chat</h2>
<p>ÊåâÁÖßÂÆòÊñπÁ§∫‰æãÔºåÁÆÄÂçïÊîπ‰∫Ü‰∏ãÔºåÊúâÂ¶Ç‰∏ãÁöÑ‰ª£Á†ÅÔºå‰∏Ä‰∏™ÊûÅÁÆÄÁöÑÂµåÂÖ•È¢ÑÁΩÆpromptÂíåÂØπËØùÁöÑ‰æãÂ≠êÔºö
ÊµÅÁ®ã‰πüÂæàÁÆÄÂçïÔºö</p>
<ol>
<li>ÂàõÂª∫prompt tmpl</li>
<li>Ê∏≤Êüìprompt tmplÂæóÂà∞ inputMessages</li>
<li>ÂàõÂª∫chatModel</li>
<li>Ë∞ÉÁî®chatModelÔºåÂ∞ÜinputMessages‰º†ÂÖ•</li>
<li>ChatModelÊòØ‰∏çÂêåÂ§ßËØ≠Ë®ÄÊ®°ÂûãÁöÑÊäΩË±°Êé•Âè£</li>
</ol>
<pre><code>type ChatModel interface {
    // Ëé∑ÂæóÂÆåÊï¥ËæìÂá∫
    Generate(ctx context.Context, input []*schema.Message, opts ...Option) (*schema.Message, error)
    // ÈÄê‰∏™tokenËæìÂá∫
    Stream(ctx context.Context, input []*schema.Message, opts ...Option) (
        *schema.StreamReader[*schema.Message], error)

    // BindTools bind tools to the model.
    // BindTools before requesting ChatModel generally.
    // notice the non-atomic problem of BindTools and Generate.
    BindTools(tools []*schema.ToolInfo) error
}
</code></pre>
<pre><code>/*
 * Copyright 2024 CloudWeGo Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package main

import (
    &quot;context&quot;
    &quot;io&quot;
    &quot;iter&quot;
    &quot;log&quot;

    &quot;github.com/cloudwego/eino-ext/components/model/ollama&quot;
    &quot;github.com/cloudwego/eino/components/prompt&quot;
    &quot;github.com/cloudwego/eino/schema&quot;
)


func main() {
    ctx := context.Background()

    // ÂàõÂª∫Ê®°ÊùøÔºå‰ΩøÁî® FString Ê†ºÂºè
    tmpl := prompt.FromMessages(schema.FString,
        // Á≥ªÁªüÊ∂àÊÅØÊ®°Êùø
        schema.SystemMessage(&quot;‰Ω†ÊòØ‰∏Ä‰∏™{role}„ÄÇ‰Ω†ÈúÄË¶ÅÁî®{style}ÁöÑËØ≠Ê∞îÂõûÁ≠îÈóÆÈ¢ò„ÄÇ‰Ω†ÁöÑÁõÆÊ†áÊòØÂ∏ÆÂä©Á®ãÂ∫èÂëò‰øùÊåÅÁßØÊûÅ‰πêËßÇÁöÑÂøÉÊÄÅÔºåÊèê‰æõÊäÄÊúØÂª∫ËÆÆÁöÑÂêåÊó∂‰πüË¶ÅÂÖ≥Ê≥®‰ªñ‰ª¨ÁöÑÂøÉÁêÜÂÅ•Â∫∑„ÄÇ&quot;),

        // ÊèíÂÖ•ÈúÄË¶ÅÁöÑÂØπËØùÂéÜÂè≤ÔºàÊñ∞ÂØπËØùÁöÑËØùËøôÈáå‰∏çÂ°´Ôºâ
        schema.MessagesPlaceholder(&quot;chat_history&quot;, true),

        // Áî®Êà∑Ê∂àÊÅØÊ®°Êùø
        schema.UserMessage(&quot;ÈóÆÈ¢ò: {question}&quot;),
    )

    // ‰ΩøÁî®Ê®°ÊùøÁîüÊàêÊ∂àÊÅØ
    messages, err := tmpl.Format(context.Background(), map[string]any{
        &quot;role&quot;:     &quot;Á®ãÂ∫èÂëòÈºìÂä±Â∏à&quot;,
        &quot;style&quot;:    &quot;ÁßØÊûÅ„ÄÅÊ∏©Êöñ‰∏î‰∏ì‰∏ö&quot;,
        &quot;question&quot;: &quot;ÊàëÁöÑ‰ª£Á†Å‰∏ÄÁõ¥Êä•ÈîôÔºåÊÑüËßâÂ•ΩÊ≤Æ‰∏ßÔºåËØ•ÊÄé‰πàÂäûÔºü&quot;,
        // ÂØπËØùÂéÜÂè≤ÔºàËøô‰∏™‰æãÂ≠êÈáåÊ®°Êãü‰∏§ËΩÆÂØπËØùÂéÜÂè≤Ôºâ
        &quot;chat_history&quot;: []*schema.Message{
            schema.UserMessage(&quot;‰Ω†Â•Ω&quot;),
            schema.AssistantMessage(&quot;ÂòøÔºÅÊàëÊòØ‰Ω†ÁöÑÁ®ãÂ∫èÂëòÈºìÂä±Â∏àÔºÅËÆ∞‰ΩèÔºåÊØè‰∏™‰ºòÁßÄÁöÑÁ®ãÂ∫èÂëòÈÉΩÊòØ‰ªé Debug ‰∏≠ÊàêÈïøËµ∑Êù•ÁöÑ„ÄÇÊúâ‰ªÄ‰πàÊàëÂèØ‰ª•Â∏Æ‰Ω†ÁöÑÂêóÔºü&quot;, nil),
            schema.UserMessage(&quot;ÊàëËßâÂæóËá™Â∑±ÂÜôÁöÑ‰ª£Á†ÅÂ§™ÁÉÇ‰∫Ü&quot;),
            schema.AssistantMessage(&quot;ÊØè‰∏™Á®ãÂ∫èÂëòÈÉΩÁªèÂéÜËøáËøô‰∏™Èò∂ÊÆµÔºÅÈáçË¶ÅÁöÑÊòØ‰Ω†Âú®‰∏çÊñ≠Â≠¶‰π†ÂíåËøõÊ≠•„ÄÇËÆ©Êàë‰ª¨‰∏ÄËµ∑ÁúãÁúã‰ª£Á†ÅÔºåÊàëÁõ∏‰ø°ÈÄöËøáÈáçÊûÑÂíå‰ºòÂåñÔºåÂÆÉ‰ºöÂèòÂæóÊõ¥Â•Ω„ÄÇËÆ∞‰ΩèÔºåRome wasn't built in a dayÔºå‰ª£Á†ÅË¥®ÈáèÊòØÈÄöËøáÊåÅÁª≠ÊîπËøõÊù•ÊèêÂçáÁöÑ„ÄÇ&quot;, nil),
        },
    })
    if err != nil {
        log.Fatalf(&quot;format template failed: %v\n&quot;, err)
    }

    // ËøûÊé•ollmaÂπ∂ÂàõÂª∫chatModel
    // ÁÆÄÂçïÂÆâË£Ö‰∏Ä‰∏ãollmaÂ∞±Ë°å: curl -fsSL https://ollama.com/install.sh | sh
    // ÁÑ∂Âêé‰∏ãËΩΩÊ®°ÂûãÔºöollama pull llama2
    chatModel, err := ollama.NewChatModel(ctx, &amp;ollama.ChatModelConfig{
        BaseURL: &quot;http://localhost:11434&quot;, // Ollama ÊúçÂä°Âú∞ÂùÄ
        Model:   &quot;llama2&quot;,                 // Ê®°ÂûãÂêçÁß∞
    })
    if err != nil {
        log.Fatalf(&quot;create ollama chat model failed: %v&quot;, err)
    }

    result, err := chatModel.Generate(ctx, messages)
    if err != nil {
        log.Fatalf(&quot;llm generate failed: %v&quot;, err)
    }
    log.Printf(&quot;result: %s\n\n&quot;, JsonIndent(result))

    streamResult, err := chatModel.Stream(ctx, messages)
    if err != nil {
        log.Fatalf(&quot;llm generate failed: %v&quot;, err)
    }

    for msg, iterInfo := range NewStreamResultIter(streamResult) {
        log.Printf(&quot;message[%d]: %+v, err=%v\n&quot;, iterInfo.I, msg, iterInfo.Err)
    }
}

func JsonIndent(v any) string {
    x, _ := json.MarshalIndent(v, &quot;&quot;, &quot;\t&quot;)
    return *(*string)(unsafe.Pointer(&amp;x))
}

type IterInfo struct {
    I   int
    Err error
}

func NewStreamResultIter(sr *schema.StreamReader[*schema.Message]) iter.Seq2[*schema.Message, IterInfo] {
    return func(yield func(*schema.Message, IterInfo) bool) {
        defer sr.Close()

        i := 0
        for {
            message, err := sr.Recv()
            if err == io.EOF {
                return
            }
            if !yield(message, IterInfo{i, err}) {
                return
            }

            i++
        }
    }
}
</code></pre>
<h2 id="ai-agent">AI Agent</h2>
<p>ÁÜüËÆ∞ ‚ÄúÊÑüÁü•-ÊÄùËÄÉ-ÊâßË°å‚ÄùÔºåÊÑüÁü•Â∞±ÊòØÊèê‰æõÁªôÂ§ßÊ®°Âûã‰∏Ä‰∫õ‰∏ä‰∏ãÊñáÔºåÊÄùËÄÉÂ∞±ÊòØÂ§ßÊ®°ÂûãË∞ÉÁî®ÔºåÊâßË°åÂ∞±ÊòØÂ§ßÊ®°ÂûãÊâßË°åÂáΩÊï∞Ë∞ÉÁî®„ÄÇÂ∫îÁî®‰∫éai agentÁöÑÂ§ßÊ®°ÂûãÈúÄË¶ÅÊîØÊåÅÂáΩÊï∞Ë∞ÉÁî®„ÄÇÊØîÂ¶ÇÂú®ollamaÈáåÔºå‰ºö‰ª•toolsÊ†áËÆ∞„ÄÇ
ÊµÅÁ®ã‰πü‰∏çÂ§çÊùÇÔºö</p>
<ol>
<li>ÁºñÂÜôtool</li>
<li>Â∞ÜtoolÊ≥®ÂÜåÂà∞chatModel</li>
<li>ÊûÑÂª∫toolNode</li>
<li>ÊûÑÂª∫chain</li>
<li>Â∞ÜtoolNodeÊ∑ªÂä†Âà∞chain</li>
<li>ÁºñËØëchain</li>
<li>Ë∞ÉÁî®chain</li>
</ol>
<pre><code>import toolutils &quot;github.com/cloudwego/eino/components/tool/utils&quot;
type CreateTodoOpts struct {
    Content string `json:&quot;content,omitempty&quot; jsonschema:&quot;description=content of the todo&quot;`
    EndTime int64  `json:&quot;end_time,omitempty&quot; jsonschema:&quot;description=deadline of the todo&quot;`
}

func (p *CreateTodoOpts) Invoke(_ context.Context, params *CreateTodoOpts) (string, error) {
    logs.Infof(&quot;invoke tool create_todo: %+v&quot;, params)
    // biz logic
    return `{&quot;msg&quot;: &quot;create todo success&quot;}`, nil
}

func main(){
    // ÊûÑÂª∫tool
    createTool, err := toolutils.InferTool(&quot;create_todo&quot;, &quot;Create a todo item, eg: content,end_time...&quot;, (&amp;CreateTodoOpts{}).Invoke)
    if err != nil {
        logs.Errorf(&quot;InferTool failed, err=%v&quot;, err)
        return
    }
    
    tools := []tool.BaseTool{
        createTool,
    }
    
    // Â∞Ü tools ÁªëÂÆöÂà∞ ChatModel
    err = chatModel.BindTools(lo.Map(todoTools, func(v tool.BaseTool, _ int) *schema.ToolInfo {
        info, _ := v.Info(ctx)
        return info
    }))
    if err != nil {
        logs.Errorf(&quot;BindTools failed, err=%v&quot;, err)
        return
    }
    
    // ÊûÑÂª∫ toolsNode ËäÇÁÇπ
    todoToolsNode, err := compose.NewToolNode(ctx, &amp;compose.ToolsNodeConfig{
        Tools: todoTools,
    })
    if err != nil {
        logs.Errorf(&quot;NewToolNode failed, err=%v&quot;, err)
        return
    }

    // ÊûÑÂª∫ÂÆåÊï¥ÁöÑÂ§ÑÁêÜÈìæ
    chain := compose.NewChain[[]*schema.Message, []*schema.Message]()
    chain.
        AppendChatModel(chatModel, compose.WithNodeName(&quot;chat_model&quot;)).
        AppendToolsNode(todoToolsNode, compose.WithNodeName(&quot;tools&quot;))

    // ÁºñËØëÂπ∂ËøêË°å chain
    agent, err := chain.Compile(ctx)
    if err != nil {
        logs.Errorf(&quot;chain.Compile failed, err=%v&quot;, err)
        return
    }
    
    resp, err := agent.Invoke(ctx, []*schema.Message{{...}})
    if err != nil {
        logs.Errorf(&quot;agent.Invoke failed, err=%v&quot;, err)
        return
    }
}
</code></pre>
<h1 id="graphchainworkflow">Graph/Chain/Workflow</h1>
<p>Graph: low-level ÁöÑÁ±ªÂûãÔºåÈúÄË¶ÅÊìç‰ΩúËäÇÁÇπÂíåËæπ
Chain: high-level ÁöÑÁ±ªÂûãÔºåÂ∫ïÂ±ÇÊìç‰Ωúgraph, pregel Ê®°Âºè„ÄÇchainÁöÑÂÖ∏ÂûãÊìç‰ΩúÊòØÁõ¥Êé•appendÔºå‰∏çÊñ≠ÁöÑÁ∫ßËÅîÊìç‰ΩúÔºå‰∏ÄÂæÄÊó†ÂâçÔºåÊó†Ê≥ïÂΩ¢ÊàêÁéØÊìç‰ΩúÔºà‰ΩÜÊòØai agentÁöÑÂºÄÂèë‰∏≠ÔºåÊØîÂ¶ÇReActÂ∞±ÊòØÁéØÔºâÔºåÈªòËÆ§ÊòØ
WorkflowÔºöhigh-level ÁöÑÁ±ªÂûãÔºåÂ∫ïÂ±ÇÊìç‰Ωúgraph, dag Ê®°Âºè„ÄÇ‰∏çÊîØÊåÅÁéØ„ÄÇAllPredecessor ËØ≠‰πâ</p>
<p>chainÂíåworkflow ‰∏ªË¶ÅÊòØÂú®ÊâßË°åÊó∂Ëé∑Âèñ‰∏ã‰∏ÄÊâπÂæÖÊâßË°åËäÇÁÇπÊó∂ÊúâÂå∫Âà´Ôºå</p>
<h1 id="component">Component</h1>
<p>Ê≥®ÊÑèÂå∫ÂàÜËäÇÁÇπÔºåÂíåÊåÇÂú®ËäÇÁÇπ‰∏äÁöÑinvokeFunc!</p>
<h2 id="tools">Tools</h2>
<p>compose.ToolsNode
ËøôÊòØ‰∏Ä‰∏™ÂõæËäÇÁÇπÔºåÂ≠òÊîætools„ÄÇ</p>
<ol>
<li>‰∏∫‰ªÄ‰πàÊòØtoolsNodeËÄå‰∏çÊòØtoolNodeÔºü</li>
<li>ÂíåÂ§ßÊ®°ÂûãÂáΩÊï∞Ë∞ÉÁî®Êú∫Âà∂ÊúâÂÖ≥ÔºåÂú®Â§ßÊ®°ÂûãÂáΩÊï∞Ë∞ÉÁî®ÈáåÔºåÊòØÂ§ßÊ®°ÂûãËøîÂõûÈúÄË¶ÅË∞ÉÁî®ÁöÑÂáΩÊï∞ÂêçÂíåÂáΩÊï∞ÂèÇÊï∞ÔºåÊàë‰ª¨Ëá™Â∑±ÂÜçÂéªË∞ÉÁî®ÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÁü•ÈÅìÊúâÂì™‰∫õÂáΩÊï∞ÂèØ‰ª•Ë¢´Ë∞ÉÁî®ÔºåÈÇ£ÂΩìÁÑ∂ÊòØÈÉΩÊîæÂú®‰∏Ä‰∏™nodeÈáåÊù•Êü•Êâæ‰∫Ü„ÄÇ
ToolsNode.Invoke
ÂõæËäÇÁÇπÊé•Êî∂‰∏Ä‰∏™input <em>schema.Message, ËøîÂõûÂ§ö‰∏™</em>schema.Message
‰πüÊØîËæÉÂêàÁêÜÔºåmessageÈáåÁöÑToolCallsÊòØ‰∏™ÂàóË°®ÔºåÂèØËÉΩÊúâÂ§ö‰∏™ÂáΩÊï∞Ë∞ÉÁî®Ë¢´Ëß¶ÂèëÔºåÂØπ‰∫éÊØè‰∏™Ëß¶ÂèëÁöÑÂáΩÊï∞Ë∞ÉÁî®ÔºåÈÉΩÊ∑ªÂä†Âà∞ËøîÂõûÂÄºÈáå</li>
</ol>
<pre><code>(tn *ToolsNode) Invoke(ctx context.Context, input *schema.Message,opts ...ToolsNodeOption) ([]*schema.Message, error)

tool.InvokableTool / StreamableTool 
Âú®eino‰∏≠ÔºåtoolË¢´ÂÆö‰πâ‰∏∫‰∏ÄÁßçinterfaceÔºö
// BaseTool get tool info for ChatModel intent recognition.
type BaseTool interface {
    // infoÊñπÊ≥ïËøîÂõûÂèÇÊï∞ÁªìÊûÑ‰ΩìÁöÑjson schemaÔºåË¢´Áî®‰∫éÂ§ßÊ®°ÂûãÁöÑfunction callÊ≥®ÂÜå
    Info(ctx context.Context) (*schema.ToolInfo, error)
}

// InvokableTool the tool for ChatModel intent recognition and ToolsNode execution.
// nolint: byted_s_interface_name
type InvokableTool interface {
    BaseTool

    // InvokableRun call function with arguments in JSON format
    // InvokableRunÊàñStreamableRun ÊòØÂÆûÈôÖÊâßË°åÁöÑÂáΩÊï∞ÔºåÈáåÈù¢‰ºöË∞ÉÁî®Áî®Êà∑‰º†ÂÖ•ÁöÑÂáΩÊï∞„ÄÇ
    // ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØ InvokableRun Êé•Âèó argumentsInJSON stringÂèÇÊï∞ÔºåËÄåÊàë‰ª¨ÂÆö‰πâÁöÑÊòØÁªìÊûÑ‰ΩìÔºåÊâÄ‰ª•‰∏≠Èó¥‰ºöÂèëÈÄÅÂ∫èÂàóÂåñÊìç‰ΩúÔºåÊ°ÜÊû∂ÂÜÖÈÉ®ÂÆåÊàêËØ•Â∫èÂàóÂåñ
    // Êú¨Ë¥®‰∏äÊù•ËØ¥ÔºåÂ§ßÊ®°ÂûãÁöÑÂú®tool_callsÂ≠óÊÆµÈáåÁöÑÂìçÂ∫îËÇØÂÆöÊòØstringÁöÑÔºåËøôÈáåInvokableRunÂ∞±ÊòØÁõ¥Êé•Êé•Êî∂Â§ßÊ®°ÂûãÁöÑËæìÂá∫ÔºåÊàñËÄÖËØ¥‰∏ä‰∏™ËäÇÁÇπÁöÑËæìÂá∫
    InvokableRun(ctx context.Context, argumentsInJSON string, opts ...Option) (string, error)
}

// StreamableTool the stream tool for ChatModel intent recognition and ToolsNode execution.
// nolint: byted_s_interface_name
type StreamableTool interface {
    BaseTool

    StreamableRun(ctx context.Context, argumentsInJSON string, opts ...Option) (*schema.StreamReader[string], error)
}
</code></pre>
<p>einoÊèê‰æõ‰∫Ü‰∏§ÁßçÊñπÊ≥ïÂàõÂª∫tool:</p>
<ul>
<li>tool.NewTool
<ul>
<li>‰º†ÂÖ•ÂèÇÊï∞ÁªìÊûÑschemaÂíåÂØπÂ∫îÁöÑÂ§ÑÁêÜÂáΩÊï∞</li>
</ul>
</li>
<li>toolutils.InferTool
<ul>
<li>‰º†ÂÖ•ÂèÇÊï∞ÁªìÊûÑ‰ΩìÔºàschemaÂÜôÂú®Ê≥®Ëß£‰∏≠ÔºâÂíåÂØπÂ∫îÁöÑÂ§ÑÁêÜÂáΩÊï∞
Áî±‰∫étoolÊòØ‰∏ÄÁßçinterfaceÔºåÊòæÁÑ∂Êàë‰ª¨‰πüÂèØ‰ª•Ëá™Â∑±ÂÆûÁé∞Ôºöcustom struct impl interface</li>
</ul>
</li>
</ul>
<h1 id="ÂêÉÈÄèreact">ÂêÉÈÄèReAct</h1>
<pre><code>/*
 * Copyright 2024 CloudWeGo Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package react

import (
    &quot;context&quot;
    &quot;io&quot;

    &quot;github.com/cloudwego/eino/components/model&quot;
    &quot;github.com/cloudwego/eino/compose&quot;
    &quot;github.com/cloudwego/eino/flow/agent&quot;
    &quot;github.com/cloudwego/eino/schema&quot;
)

type state struct {
    Messages                 []*schema.Message
    ReturnDirectlyToolCallID string
}

const (
    nodeKeyTools = &quot;tools&quot;
    nodeKeyModel = &quot;chat&quot;
)

// MessageModifier modify the input messages before the model is called.
type MessageModifier func(ctx context.Context, input []*schema.Message) []*schema.Message

// AgentConfig is the config for ReAct agent.
type AgentConfig struct {
    // ToolCallingModel is the chat model to be used for handling user messages with tool calling capability.
    // This is the recommended model field to use.
    ToolCallingModel model.ToolCallingChatModel

    // Deprecated: Use ToolCallingModel instead.
    Model model.ChatModel

    // ToolsConfig is the config for tools node.
    ToolsConfig compose.ToolsNodeConfig

    // MessageModifier.
    // modify the input messages before the model is called, it's useful when you want to add some system prompt or other messages.
    MessageModifier MessageModifier

    // MaxStep.
    // default 12 of steps in pregel (node num + 10).
    MaxStep int `json:&quot;max_step&quot;`

    // Tools that will make agent return directly when the tool is called.
    // When multiple tools are called and more than one tool is in the return directly list, only the first one will be returned.
    ToolReturnDirectly map[string]struct{}

    // StreamOutputHandler is a function to determine whether the model's streaming output contains tool calls.
    // Different models have different ways of outputting tool calls in streaming mode:
    // - Some models (like OpenAI) output tool calls directly
    // - Others (like Claude) output text first, then tool calls
    // This handler allows custom logic to check for tool calls in the stream.
    // It should return:
    // - true if the output contains tool calls and agent should continue processing
    // - false if no tool calls and agent should stop
    // Note: This field only needs to be configured when using streaming mode
    // Note: The handler MUST close the modelOutput stream before returning
    // Optional. By default, it checks if the first chunk contains tool calls.
    // Note: The default implementation does not work well with Claude, which typically outputs tool calls after text content.
    // Note: If your ChatModel doesn't output tool calls first, you can try adding prompts to constrain the model from generating extra text during the tool call.
    StreamToolCallChecker func(ctx context.Context, modelOutput *schema.StreamReader[*schema.Message]) (bool, error)
}

// Deprecated: This approach of adding persona involves unnecessary slice copying overhead.
// Instead, directly include the persona message in the input messages when calling Generate or Stream.
//
// NewPersonaModifier add the system prompt as persona before the model is called.
// example:
//
//  persona := &quot;You are an expert in golang.&quot;
//  config := AgentConfig{
//      Model: model,
//      MessageModifier: NewPersonaModifier(persona),
//  }
//  agent, err := NewAgent(ctx, config)
//  if err != nil {return}
//  msg, err := agent.Generate(ctx, []*schema.Message{{Role: schema.User, Content: &quot;how to build agent with eino&quot;}})
//  if err != nil {return}
//  println(msg.Content)
func NewPersonaModifier(persona string) MessageModifier {
    return func(ctx context.Context, input []*schema.Message) []*schema.Message {
        res := make([]*schema.Message, 0, len(input)+1)

        res = append(res, schema.SystemMessage(persona))
        res = append(res, input...)
        return res
    }
}

func firstChunkStreamToolCallChecker(_ context.Context, sr *schema.StreamReader[*schema.Message]) (bool, error) {
    defer sr.Close()

    for {
        msg, err := sr.Recv()
        if err == io.EOF {
            return false, nil
        }
        if err != nil {
            return false, err
        }

        if len(msg.ToolCalls) &gt; 0 {
            return true, nil
        }

        if len(msg.Content) == 0 { // skip empty chunks at the front
            continue
        }

        return false, nil
    }
}

const (
    GraphName     = &quot;ReActAgent&quot;
    ModelNodeName = &quot;ChatModel&quot;
    ToolsNodeName = &quot;Tools&quot;
)

// Agent is the ReAct agent.
// ReAct agent is a simple agent that handles user messages with a chat model and tools.
// ReAct will call the chat model, if the message contains tool calls, it will call the tools.
// if the tool is configured to return directly, ReAct will return directly.
// otherwise, ReAct will continue to call the chat model until the message contains no tool calls.
// e.g.
//
//  agent, err := ReAct.NewAgent(ctx, &amp;react.AgentConfig{})
//  if err != nil {...}
//  msg, err := agent.Generate(ctx, []*schema.Message{{Role: schema.User, Content: &quot;how to build agent with eino&quot;}})
//  if err != nil {...}
//  println(msg.Content)
type Agent struct {
    runnable         compose.Runnable[[]*schema.Message, *schema.Message]
    graph            *compose.Graph[[]*schema.Message, *schema.Message]
    graphAddNodeOpts []compose.GraphAddNodeOpt
}

// NewAgent creates a ReAct agent that feeds tool response into next round of Chat Model generation.
//
// IMPORTANT!! For models that don't output tool calls in the first streaming chunk (e.g. Claude)
// the default StreamToolCallChecker may not work properly since it only checks the first chunk for tool calls.
// In such cases, you need to implement a custom StreamToolCallChecker that can properly detect tool calls.
func NewAgent(ctx context.Context, config *AgentConfig) (_ *Agent, err error) {
    var (
        chatModel       model.BaseChatModel
        toolsNode       *compose.ToolsNode
        toolInfos       []*schema.ToolInfo
        toolCallChecker = config.StreamToolCallChecker
        messageModifier = config.MessageModifier
    )

    if toolCallChecker == nil {
        toolCallChecker = firstChunkStreamToolCallChecker
    }

    if toolInfos, err = genToolInfos(ctx, config.ToolsConfig); err != nil {
        return nil, err
    }

    if chatModel, err = agent.ChatModelWithTools(config.Model, config.ToolCallingModel, toolInfos); err != nil {
        return nil, err
    }

    if toolsNode, err = compose.NewToolNode(ctx, &amp;config.ToolsConfig); err != nil {
        return nil, err
    }

    graph := compose.NewGraph[[]*schema.Message, *schema.Message](compose.WithGenLocalState(func(ctx context.Context) *state {
        return &amp;state{Messages: make([]*schema.Message, 0, config.MaxStep+1)}
    }))

    // ÂõæÁöÑIOÊ†ºÂºèÊòØÔºà[]*schema.Message, *schema.MessageÔºâÔºå ÊâÄ‰ª• modelPreHandle ÁöÑËæìÂÖ•ÂøÖÈ°ªÊòØ[]*schema.Message
    modelPreHandle := func(ctx context.Context, input []*schema.Message, state *state) ([]*schema.Message, error) {
        // Ê≥®ÊÑè model ËäÇÁÇπÁöÑÂâçÁΩÆËäÇÁÇπÂèØ‰ª•ÊòØÁî®Êà∑ËæìÂÖ•START, ‰πüÂèØ‰ª•ÊòØÂ∑•ÂÖ∑ËäÇÁÇπÔºå‰∏çËøáÊ≤°ÂÖ≥Á≥ªÔºåÂ∑•ÂÖ∑ËäÇÁÇπÁöÑËæìÂá∫‰πüÊòØ []*schema.MessageÔºåÁ±ªÂûãÊòØÂØπÁöÑ‰∏äÁöÑ
        // ËøôÈáåÂèØ‰ª•ÂõûÂøÜ‰∏ãÔºåÂ∑•ÂÖ∑ËäÇÁÇπÁöÑÁ≠æÂêç‰∏ÄËà¨ÊòØÔºà*schema.Message,[]*schema.MessageÔºâ, ‰∏öÂä°‰∏Ä‰∏™messageÂèØËÉΩË∞ÉÁî®Â§ö‰∏™function call
        state.Messages = append(state.Messages, input...)

        if messageModifier == nil {
            return state.Messages, nil
        }

        modifiedInput := make([]*schema.Message, len(state.Messages))
        copy(modifiedInput, state.Messages)
        return messageModifier(ctx, modifiedInput), nil
    }

    if err = graph.AddChatModelNode(nodeKeyModel, chatModel, compose.WithStatePreHandler(modelPreHandle), compose.WithNodeName(ModelNodeName)); err != nil {
        return nil, err
    }

    if err = graph.AddEdge(compose.START, nodeKeyModel); err != nil {
        return nil, err
    }

    toolsNodePreHandle := func(ctx context.Context, input *schema.Message, state *state) (*schema.Message, error) {
        state.Messages = append(state.Messages, input)
        // Â≠òÂÇ® ReturnDirectlyToolCallID ‰ª•‰æø‰∫éËÉΩÂú®ÂêéÁª≠ËäÇÁÇπ‰∏≠ÊâæÂà∞ÂØπÂ∫îÁöÑfunctionÁöÑcallIDÔºà‰∏Ä‰∏™Â∑•ÂÖ∑ËäÇÁÇπÂèØËÉΩË∞ÉÁî®ÂæàÂ§ö‰∏™functionÔºâ
        // ÊàëÊÑüËßâÂ¶ÇÊûúmessageÊúâ‰∏™Â≠óÊÆµÊòØfunction_name, ÂÖ∂ÂÆûÂ∞±Ëß£ÂÜ≥‰∫Ü
        state.ReturnDirectlyToolCallID = getReturnDirectlyToolCallID(input, config.ToolReturnDirectly)
        return input, nil
    }
    if err = graph.AddToolsNode(nodeKeyTools, toolsNode, compose.WithStatePreHandler(toolsNodePreHandle), compose.WithNodeName(ToolsNodeName)); err != nil {
        return nil, err
    }

    modelPostBranchCondition := func(_ context.Context, sr *schema.StreamReader[*schema.Message]) (endNode string, err error) {
        // ÂàÜÊîØÊù°‰ª∂ÔºåÂÜ≥ÂÆöÂ∑•ÂÖ∑ËäÇÁÇπÊòØÊåáÂêëÊ®°ÂûãËäÇÁÇπÔºåËøòÊòØÊåáÂêë DirectReturn ËäÇÁÇπ
        if isToolCall, err := toolCallChecker(ctx, sr); err != nil {
            return &quot;&quot;, err
        } else if isToolCall {
            return nodeKeyTools, nil
        }
        return compose.END, nil
    }

    // Ê≥®ÊÑèÔºåÊåáÂêëEndÊó∂ÔºåÈúÄË¶Å‰ΩøÁî®NewStreamGraphBranchÔºåÂõ†‰∏∫Êàë‰ª¨Â∞Ü‰ΩøÁî®StreamÊ®°ÂºèË∞ÉÁî®ReactAgent
    // ËøôÈáåÂ¶ÇÊûú‰∏çÁî®StreamÔºåÂΩìÁÑ∂‰πüË°åÔºåEino‰ºöÂ∏ÆÊàë‰ª¨ËøõË°åStream/BatchÁöÑËΩ¨Êç¢Ôºå‰ΩÜÊòØÂ∞±‰∏çÊòØÊµÅÂºèËæìÂá∫‰∫Ü
    if err = graph.AddBranch(nodeKeyModel, compose.NewStreamGraphBranch(modelPostBranchCondition, map[string]bool{nodeKeyTools: true, compose.END: true})); err != nil {
        return nil, err
    }

    if len(config.ToolReturnDirectly) &gt; 0 {
        if err = buildReturnDirectly(graph); err != nil {
            return nil, err
        }
    } else if err = graph.AddEdge(nodeKeyTools, nodeKeyModel); err != nil {
        return nil, err
    }

    compileOpts := []compose.GraphCompileOption{compose.WithMaxRunSteps(config.MaxStep), compose.WithNodeTriggerMode(compose.AnyPredecessor), compose.WithGraphName(GraphName)}
    runnable, err := graph.Compile(ctx, compileOpts...)
    if err != nil {
        return nil, err
    }

    return &amp;Agent{
        runnable:         runnable,
        graph:            graph,
        graphAddNodeOpts: []compose.GraphAddNodeOpt{compose.WithGraphCompileOptions(compileOpts...)},
    }, nil
}

func buildReturnDirectly(graph *compose.Graph[[]*schema.Message, *schema.Message]) (err error) {
    // Ê≥®ÊÑè directReturn ÁöÑÁ≠æÂêçÔºåÊØîËæÉÊúâÊÑèÊÄù Ôºà*schema.StreamReader[[]*schema.Message] Ôºå*schema.StreamReader[*schema.Message]Ôºâ ÔºådirectReturnËäÇÁÇπÁöÑÂâçÁΩÆËäÇÁÇπÊòØÂ∑•ÂÖ∑ËäÇÁÇπÔºåÁ≠æÂêçÊòØ[]*schema.MessageÔºåÊâÄ‰ª•ËøôÈáåÂÜô*schema.StreamReader[[]*schema.Message]ÊàñËÄÖ []*schema.MessageÂ∫îËØ•ÈÉΩË°åÔºåÂõ†‰∏∫ÂõæÂÄæÂêëÊµÅÂºèËæìÂá∫ÔºåÊâÄ‰ª•ËæìÂá∫ÊòØ*schema.StreamReader[*schema.Message]ÔºåEinoÂÜÖÈÉ®‰ºöÂÅöÊâπÊµÅÁöÑÁ±ªÂûãÂ§ÑÁêÜ
    directReturn := func(ctx context.Context, msgs *schema.StreamReader[[]*schema.Message]) (*schema.StreamReader[*schema.Message], error) {
        return schema.StreamReaderWithConvert(msgs, func(msgs []*schema.Message) (*schema.Message, error) {
            var msg *schema.Message
            err = compose.ProcessState[*state](ctx, func(_ context.Context, state *state) error {
                for i := range msgs {
                    if msgs[i] != nil &amp;&amp; msgs[i].ToolCallID == state.ReturnDirectlyToolCallID {
                        msg = msgs[i]
                        return nil
                    }
                }
                return nil
            })
            if err != nil {
                return nil, err
            }
            if msg == nil {
                return nil, schema.ErrNoValue
            }
            return msg, nil
        }), nil
    }

    nodeKeyDirectReturn := &quot;direct_return&quot;
    if err = graph.AddLambdaNode(nodeKeyDirectReturn, compose.TransformableLambda(directReturn)); err != nil {
        return err
    }

    // this branch checks if the tool called should return directly. It either leads to END or back to ChatModel
    err = graph.AddBranch(nodeKeyTools, compose.NewStreamGraphBranch(func(ctx context.Context, msgsStream *schema.StreamReader[[]*schema.Message]) (endNode string, err error) {
        msgsStream.Close()

        err = compose.ProcessState[*state](ctx, func(_ context.Context, state *state) error {
            if len(state.ReturnDirectlyToolCallID) &gt; 0 {
                endNode = nodeKeyDirectReturn
            } else {
                endNode = nodeKeyModel
            }
            return nil
        })
        if err != nil {
            return &quot;&quot;, err
        }
        return endNode, nil
    }, map[string]bool{nodeKeyModel: true, nodeKeyDirectReturn: true}))
    if err != nil {
        return err
    }

    return graph.AddEdge(nodeKeyDirectReturn, compose.END)
}

func genToolInfos(ctx context.Context, config compose.ToolsNodeConfig) ([]*schema.ToolInfo, error) {
    toolInfos := make([]*schema.ToolInfo, 0, len(config.Tools))
    for _, t := range config.Tools {
        tl, err := t.Info(ctx)
        if err != nil {
            return nil, err
        }

        toolInfos = append(toolInfos, tl)
    }

    return toolInfos, nil
}

func getReturnDirectlyToolCallID(input *schema.Message, toolReturnDirectly map[string]struct{}) string {
    if len(toolReturnDirectly) == 0 {
        return &quot;&quot;
    }

    for _, toolCall := range input.ToolCalls {
        if _, ok := toolReturnDirectly[toolCall.Function.Name]; ok {
            return toolCall.ID
        }
    }

    return &quot;&quot;
}

// Generate generates a response from the agent.
func (r *Agent) Generate(ctx context.Context, input []*schema.Message, opts ...agent.AgentOption) (*schema.Message, error) {
    return r.runnable.Invoke(ctx, input, agent.GetComposeOptions(opts...)...)
}

// Stream calls the agent and returns a stream response.
func (r *Agent) Stream(ctx context.Context, input []*schema.Message, opts ...agent.AgentOption) (output *schema.StreamReader[*schema.Message], err error) {
    return r.runnable.Stream(ctx, input, agent.GetComposeOptions(opts...)...)
}

// ExportGraph exports the underlying graph from Agent, along with the []compose.GraphAddNodeOpt to be used when adding this graph to another graph.
func (r *Agent) ExportGraph() (compose.AnyGraph, []compose.GraphAddNodeOpt) {
    return r.graph, r.graphAddNodeOpts
}
</code></pre>
<h1 id="ÂõæÊâßË°å">ÂõæÊâßË°å</h1>
<pre><code>nextTasks, result, err = r.calculateNextTasks(ctx, []*task{{
    nodeKey: START,
    call:    r.inputChannels,
    output:  input,
}}, isStream, cm, optMap) // ËÆ°ÁÆóÂá∫‰∏ã‰∏ÄÊâπ‰ªªÂä°Ôºå‰ªéÂÖ®ÈáèËäÇÁÇπmap‰∏≠ÊâæÂà∞ inputChannel ÈùûÁ©∫ÁöÑËäÇÁÇπÔºàÂÆûÈôÖÂÆûÁé∞ÂíågraphÁ±ªÂûãÊúâÂÖ≥ÔºåÂ¶ÇÊûúÊòØpregelÔºåÂè™ÊîØÊåÅ AnyPredecessor Ê®°ÂºèÔºå‰πüÂ∞±ÊòØ‰ªª‰∏Ä‰∏™‰æùËµñÂÆåÊàêÔºåÂΩìÂâçËäÇÁÇπÂ∞±ÂèØ‰ª•ËøêË°åÔºâ
for step := 0; ; step++ {
        // Check for context cancellation.
        select {
        case &lt;-ctx.Done():
            _ = tm.waitAll()
            return nil, newGraphRunError(fmt.Errorf(&quot;context has been canceled: %w&quot;, ctx.Err()))
        default:
        }
        if !r.dag &amp;&amp; step &gt;= maxSteps {
            return nil, newGraphRunError(ErrExceedMaxSteps)
        }

        // 1. submit next tasks
        // 2. get completed tasks
        // 3. calculate next tasks

        err = tm.submit(nextTasks) // ÂºÇÊ≠•ÊàñÂêåÊ≠•ÁöÑÊèê‰∫§‰∏ÄÊâπ‰ªªÂä°
        if err != nil {
            return nil, newGraphRunError(fmt.Errorf(&quot;failed to submit tasks: %w&quot;, err))
        }
        var completedTasks []*task
        completedTasks = tm.wait() // ÈªòËÆ§ÊòØ wait one, ‰πüÂ∞±ÊòØËØ¥‰∏Ä‰∏™ËäÇÁÇπÂ•Ω‰πãÂêéÔºåÂºÄÂßã‰∏ã‰∏ÄËΩÆ‰∏ªÂæ™ÁéØ
        
        
        // ...
        nextTasks, result, err = r.calculateNextTasks(ctx, completedTasks, isStream, cm, optMap)
        // ...
}
func (t *taskManager) submit(tasks []*task) error {
    // ...
    for _, currentTask := range tasks {
        t.num += 1
        go t.execute(currentTask)
    }
    // ...
}

func (t *taskManager) execute(currentTask *task) {
    defer func() {
        panicInfo := recover()
        if panicInfo != nil {
            currentTask.output = nil
            currentTask.err = safe.NewPanicErr(panicInfo, debug.Stack())
        }

        t.done.Send(currentTask)
    }()

    ctx := initNodeCallbacks(currentTask.ctx, currentTask.nodeKey, currentTask.call.action.nodeInfo, currentTask.call.action.meta, t.opts...)
    currentTask.output, currentTask.err = t.runWrapper(ctx, currentTask.call.action, currentTask.input, currentTask.option...)
}

func (t *taskManager) wait() []*task {
    if t.needAll {
        return t.waitAll()
    }

    ta, success := t.waitOne()
    if !success {
        return []*task{}
    }

    return []*task{ta}
}
</code></pre>
<h2 id="passthrough-ËäÇÁÇπ">passthrough ËäÇÁÇπ</h2>
<p>Âú®AnyPredecessor ËØ≠‰πâÊâßË°åÊó∂Ôºå‰ªª‰∏ÄÂâçÁΩÆËäÇÁÇπ‰ºöËß¶ÂèëÂêéÁª≠ËäÇÁÇπÊâßË°å
ÂØπ‰∫éÂ¶Ç‰∏ãÁöÑÂõæÔºö
a -&gt; b -&gt; c
a -&gt; c
ÂΩìaÊâßË°åÂÆåÂêéÔºåbÂíåc‰ºö‰∏ÄËµ∑ÊâßË°åÔºåËÇØÂÆö‰∏çÁ¨¶ÂêàÈ¢ÑÊúüÔºåÊâÄ‰ª•ÈúÄË¶ÅÂú®a-&gt;c Áõ¥Êé•ÊèíÂÖ• passthrough (actually nop) ËäÇÁÇπÔºåÁ≠â‰∏ÄÂõûÂêàÂÜçÊâßË°å</p>
<h1 id="ÂÜÖÈÉ®ÈöêÂºèÁ±ªÂûãËΩ¨Êç¢">ÂÜÖÈÉ®ÈöêÂºèÁ±ªÂûãËΩ¨Êç¢Ôºö</h1>
<ul>
<li>Â¶ÇÊûú‰∏ä‰∏ãÊ∏∏ËäÇÁÇπÁöÑÊµÅÁ±ªÂûãÊó†Ê≥ïÂåπÈÖç„ÄÇ Eino‰ºöËá™Âä®ÂÆåÊàê ÊµÅÂåñ„ÄÅÂêàÂåÖ ‰∏§‰∏™Êìç‰Ωú
<ul>
<li>ÊµÅÂåñ(Streaming)ÔºöÂ∞Ü T ÊµÅÂåñÊàêÂçï Chunk ÁöÑ Stream[T]</li>
<li>ÂêàÂåÖ(Concat)ÔºöÂ∞Ü Stream[T] ÂêàÂπ∂Êàê‰∏Ä‰∏™ÂÆåÊï¥ÁöÑ T„ÄÇ</li>
</ul>
</li>
<li>Â¶ÇÊûú‰∏Ä‰∏™ËäÇÁÇπË¶ÅÊé•Êî∂Â§ö‰∏™ËäÇÁÇπÁöÑËæìÂá∫ÔºàÂç≥AllPredessorÊ®°ÂºèÔºâÔºåÈÇ£‰πàÈúÄË¶ÅÂ∞ÜËæìÂá∫ÂÆö‰πâÊàêMap, ‰ª•Êñπ‰æøÂêàÂπ∂ËæìÂá∫</li>
</ul>

    </div>
    <div class="article-footer">
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    <li class="post-copyright-link hidden-xs">
      <strong>Permalink: </strong>
      <a href="https://wymli.github.io/2025/05/aiagent-eino/" title="[AI Agent] Eino" target="_blank" rel="external">https://wymli.github.io/2025/05/aiagent-eino/</a>
    </li>
    <li class="post-copyright-license">
      <strong>License: </strong>
        <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a>
    </li>
  </ul>
</blockquote>

<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/wymli" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://wymli.github.io/me.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/wymli" target="_blank"><span class="text-dark">Li Weiming</span><small class="ml-1x">wymli@sysu.cse</small></a></h3>
        <div>ONE CAN GO FAST</div>
      </div>
    </figure>
  </div>
</div>

    </div>
  </article>
</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://wymli.github.io/2025/05/db-mutex/" title="[DB] ‰∫ãÂä°ÈöîÁ¶ª‰∏éÈîÅ"><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;Older</span></a>
            </li>
            <li class="next">
                <a href="https://wymli.github.io/2021/04/a1underthehood-underthehood/"
                    title="[UnderTheHood] Âü∫Á°Ä-ÈáçË¶Å-Áü•ËØÜ-ÊïôÊó®-Ê†ºË®Ä-Ëùâ"><span>Newer&nbsp;&nbsp;</span><i
                        class="icon icon-angle-right" aria-hidden="true"></i></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false"
                    title="Catalogue" role="button">
                    <span>[&nbsp;</span><span>Catalogue</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter"
                data-mobile-sites="weibo,qq,qzone"></div>
        </div>
    </div>
</nav>


</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/wymli" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://wymli.github.io/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2021  -
    2025
    <div class="publishby">
        Theme by <a href="https://github.com/xiaoheiAh" target="_blank"> xiaoheiAh </a>base on<a href="https://github.com/xiaoheiAh/hugo-theme-pure" target="_blank"> pure</a>.
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('\x3Cscript src="js/jquery.min.js"><\/script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/python.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/javascript.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/go.min.js" defer></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://wymli.github.io/js/application.min.e4989ab4dc212027af8773861b05b6bc333a1217f6b0a1b3377a3a3dbd454483.js"></script>
<script src="https://wymli.github.io/js/plugin.min.353ef3573cf0beb9b69d43450140ff59f497f732396f539052fc4973c6330fdb.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            ROOT_URL: 'https:\/\/wymli.github.io\/',
            CONTENT_URL: 'https:\/\/wymli.github.io\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://wymli.github.io/js/insight.min.716b0c6a00b68ccc31a2b65345f3412f4246ffa94a90f8e25d525528b4504f9937880692bbe619023233caba5d0a17ebe23d7cfb57cd3a88f23ea337ad5e4d00.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>



  </body>
</html>
