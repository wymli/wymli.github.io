<!DOCTYPE html>
<html lang="en">
  <head>
    <title>
        [BigData] spark - UnderTheHood
      </title>
        <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    
    <meta name="theme-color" content="#000000" />
    
    <meta http-equiv="window-target" content="_top" />
    
    
    <meta name="description" content="Spark Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ ÊîØÊåÅÊµÅÂºèÊàñÊâπÂºè sparkÊèê‰∫§Êúâ‰∏Ä‰∏™ÂçïÁã¨ÁöÑspark-commit.shËÑöÊú¨ ÊâπÂ§ÑÁêÜÊòØspark core ÊµÅÂ§ÑÁêÜÊòØspark streamingÔºåËøôÈáåÁöÑÊµÅÂú®ÂÆûÁé∞‰∏äÊòØ‰ºö‰º†ÂÖ•‰∏Ä‰∏™Á™óÂè£Â§ßÂ∞èÂíå‰∏ã‰∏Ä‰∏™Á™óÂè£ÁöÑ‰ΩçÁßªÔºåÊù•‰∫ßÁîüRDDÔºå‰∏Ä‰∏™RDDÂ∞±ÊòØ‰∏Ä‰∏™Á™óÂè£ÁöÑÂ∞èÊâπÊ¨°Êï∞ÊçÆÔºåÊâÄ‰ª•spark streamingÂè™ÊòØÂú®ÊâπÂºèspark core‰∏äÂåÖË£Ö‰∫Ü‰∏Ä‰∏ã„ÄÇ ÊâßË°åÊµÅÁ®ã ‰∏Ä‰∏™spark Â∫îÁî®ÁöÑÊµÅÁ®ãÊòØËøôÊ†∑ÁöÑÔºö
" />
    <meta name="generator" content="Hugo 0.145.0 with theme pure" />
    <title>[BigData] spark - UnderTheHood</title>
    
    
    <link rel="stylesheet" href="https://wymli.github.io/css/style.min.31c841d028bbb1b4f57eadc51e8f652fb1d4f783171c15f4f5de039708e133b3.css">
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.15.10/styles/github.min.css" async>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css" async>
    <meta property="og:url" content="https://wymli.github.io/2022/04/big-data-spark/">
  <meta property="og:site_name" content="UnderTheHood">
  <meta property="og:title" content="[BigData] spark">
  <meta property="og:description" content="Spark Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ ÊîØÊåÅÊµÅÂºèÊàñÊâπÂºè sparkÊèê‰∫§Êúâ‰∏Ä‰∏™ÂçïÁã¨ÁöÑspark-commit.shËÑöÊú¨ ÊâπÂ§ÑÁêÜÊòØspark core ÊµÅÂ§ÑÁêÜÊòØspark streamingÔºåËøôÈáåÁöÑÊµÅÂú®ÂÆûÁé∞‰∏äÊòØ‰ºö‰º†ÂÖ•‰∏Ä‰∏™Á™óÂè£Â§ßÂ∞èÂíå‰∏ã‰∏Ä‰∏™Á™óÂè£ÁöÑ‰ΩçÁßªÔºåÊù•‰∫ßÁîüRDDÔºå‰∏Ä‰∏™RDDÂ∞±ÊòØ‰∏Ä‰∏™Á™óÂè£ÁöÑÂ∞èÊâπÊ¨°Êï∞ÊçÆÔºåÊâÄ‰ª•spark streamingÂè™ÊòØÂú®ÊâπÂºèspark core‰∏äÂåÖË£Ö‰∫Ü‰∏Ä‰∏ã„ÄÇ ÊâßË°åÊµÅÁ®ã ‰∏Ä‰∏™spark Â∫îÁî®ÁöÑÊµÅÁ®ãÊòØËøôÊ†∑ÁöÑÔºö">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-04-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2022-04-15T00:00:00+00:00">
    <meta property="article:tag" content="BigData">

  <meta itemprop="name" content="[BigData] spark">
  <meta itemprop="description" content="Spark Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ ÊîØÊåÅÊµÅÂºèÊàñÊâπÂºè sparkÊèê‰∫§Êúâ‰∏Ä‰∏™ÂçïÁã¨ÁöÑspark-commit.shËÑöÊú¨ ÊâπÂ§ÑÁêÜÊòØspark core ÊµÅÂ§ÑÁêÜÊòØspark streamingÔºåËøôÈáåÁöÑÊµÅÂú®ÂÆûÁé∞‰∏äÊòØ‰ºö‰º†ÂÖ•‰∏Ä‰∏™Á™óÂè£Â§ßÂ∞èÂíå‰∏ã‰∏Ä‰∏™Á™óÂè£ÁöÑ‰ΩçÁßªÔºåÊù•‰∫ßÁîüRDDÔºå‰∏Ä‰∏™RDDÂ∞±ÊòØ‰∏Ä‰∏™Á™óÂè£ÁöÑÂ∞èÊâπÊ¨°Êï∞ÊçÆÔºåÊâÄ‰ª•spark streamingÂè™ÊòØÂú®ÊâπÂºèspark core‰∏äÂåÖË£Ö‰∫Ü‰∏Ä‰∏ã„ÄÇ ÊâßË°åÊµÅÁ®ã ‰∏Ä‰∏™spark Â∫îÁî®ÁöÑÊµÅÁ®ãÊòØËøôÊ†∑ÁöÑÔºö">
  <meta itemprop="datePublished" content="2022-04-15T00:00:00+00:00">
  <meta itemprop="dateModified" content="2022-04-15T00:00:00+00:00">
  <meta itemprop="wordCount" content="4802">
  <meta itemprop="keywords" content="BigData">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[BigData] spark">
  <meta name="twitter:description" content="Spark Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂ ÊîØÊåÅÊµÅÂºèÊàñÊâπÂºè sparkÊèê‰∫§Êúâ‰∏Ä‰∏™ÂçïÁã¨ÁöÑspark-commit.shËÑöÊú¨ ÊâπÂ§ÑÁêÜÊòØspark core ÊµÅÂ§ÑÁêÜÊòØspark streamingÔºåËøôÈáåÁöÑÊµÅÂú®ÂÆûÁé∞‰∏äÊòØ‰ºö‰º†ÂÖ•‰∏Ä‰∏™Á™óÂè£Â§ßÂ∞èÂíå‰∏ã‰∏Ä‰∏™Á™óÂè£ÁöÑ‰ΩçÁßªÔºåÊù•‰∫ßÁîüRDDÔºå‰∏Ä‰∏™RDDÂ∞±ÊòØ‰∏Ä‰∏™Á™óÂè£ÁöÑÂ∞èÊâπÊ¨°Êï∞ÊçÆÔºåÊâÄ‰ª•spark streamingÂè™ÊòØÂú®ÊâπÂºèspark core‰∏äÂåÖË£Ö‰∫Ü‰∏Ä‰∏ã„ÄÇ ÊâßË°åÊµÅÁ®ã ‰∏Ä‰∏™spark Â∫îÁî®ÁöÑÊµÅÁ®ãÊòØËøôÊ†∑ÁöÑÔºö">

    <!--[if lte IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
      <![endif]-->

    <!--[if lt IE 9]>
        <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
      <![endif]-->
  </head>

  
  

  <body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader">
    <div class="slimContent">
      <div class="navbar-header">
        <div class="profile-block text-center">
          <a id="avatar" href="https://github.com/wymli" target="_blank">
            <img class="img-circle img-rotate" src="https://wymli.github.io/me.jpg" width="200" height="200">
          </a>
          <h2 id="name" class="hidden-xs hidden-sm">Li Weiming</h2>
          <h3 id="title" class="hidden-xs hidden-sm hidden-md">wymli@sysu.cse</h3>
          <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Guangzhou, China</small>
        </div><div class="search" id="search-form-wrap">
    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="Search" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i
                        class="icon icon-search"></i></button>
            </span>
        </div>
        <div class="ins-search">
            <div class="ins-search-mask"></div>
            <div class="ins-search-container">
                <div class="ins-input-wrapper">
                    <input type="text" class="ins-search-input" placeholder="Type something..."
                        x-webkit-speech />
                    <button type="button" class="close ins-close ins-selectable" data-dismiss="modal"
                        aria-label="Close"><span aria-hidden="true">√ó</span></button>
                </div>
                <div class="ins-section-wrapper">
                    <div class="ins-section-container"></div>
                </div>
            </div>
        </div>
    </form>
</div>
        <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
        <ul class="nav navbar-nav main-nav">
            <li class="menu-item menu-item-home">
                <a href="/">
                    <i class="icon icon-home-fill"></i>
                  <span class="menu-title">Home</span>
                </a>
            </li>
            <li class="menu-item menu-item-archives">
                <a href="/posts/">
                    <i class="icon icon-archives-fill"></i>
                  <span class="menu-title">Archives</span>
                </a>
            </li>
            <li class="menu-item menu-item-categories">
                <a href="/categories/">
                    <i class="icon icon-folder"></i>
                  <span class="menu-title">Categories</span>
                </a>
            </li>
            <li class="menu-item menu-item-tags">
                <a href="/tags/">
                    <i class="icon icon-tags"></i>
                  <span class="menu-title">Tags</span>
                </a>
            </li>
            <li class="menu-item menu-item-about">
                <a href="/about/">
                    <i class="icon icon-cup-fill"></i>
                  <span class="menu-title">About</span>
                </a>
            </li>
        </ul>
      </nav>
    </div>
  </header>

<aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">Board</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content"><p>üíïüòéüê±‚Äçüë§üê±‚Äçüèç‚ú®</p>
            </div>
        </div>
    </div>
</div>

      <div class="widget">
    <h3 class="widget-title"> Tags</h3>
    <div id="tag-cloud-list" class="widget-body">
            
            
            <a href="https://wymli.github.io/tags/ai-agent/" class="tag-list-link" rel="1">ai agent<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/airflow/" class="tag-list-link" rel="1">airflow<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/algorithm/" class="tag-list-link" rel="1">algorithm<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/arch/" class="tag-list-link" rel="1">arch<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/argo/" class="tag-list-link" rel="1">argo<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/atomic/" class="tag-list-link" rel="1">atomic<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/bigdata/" class="tag-list-link" rel="3">bigdata<span
               class="tag-list-count">3</span></a>
            
            
            <a href="https://wymli.github.io/tags/bytedance/" class="tag-list-link" rel="1">bytedance<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/c/" class="tag-list-link" rel="2">c<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/cache/" class="tag-list-link" rel="1">cache<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/cli/" class="tag-list-link" rel="2">cli<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/concurrency/" class="tag-list-link" rel="1">concurrency<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/container/" class="tag-list-link" rel="6">container<span
               class="tag-list-count">6</span></a>
            
            
            <a href="https://wymli.github.io/tags/containerd/" class="tag-list-link" rel="1">containerd<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/database/" class="tag-list-link" rel="4">database<span
               class="tag-list-count">4</span></a>
            
            
            <a href="https://wymli.github.io/tags/datamining/" class="tag-list-link" rel="1">datamining<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/datastructure/" class="tag-list-link" rel="1">datastructure<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/db/" class="tag-list-link" rel="1">db<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/deploy/" class="tag-list-link" rel="1">deploy<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/designpattern/" class="tag-list-link" rel="1">designpattern<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/distribute/" class="tag-list-link" rel="1">distribute<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/eino/" class="tag-list-link" rel="1">eino<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/epoll/" class="tag-list-link" rel="1">epoll<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/event-stream/" class="tag-list-link" rel="1">event-stream<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/golang/" class="tag-list-link" rel="20">golang<span
               class="tag-list-count">20</span></a>
            
            
            <a href="https://wymli.github.io/tags/gpu/" class="tag-list-link" rel="2">gpu<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/http/" class="tag-list-link" rel="2">http<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/interview/" class="tag-list-link" rel="3">interview<span
               class="tag-list-count">3</span></a>
            
            
            <a href="https://wymli.github.io/tags/js/" class="tag-list-link" rel="1">js<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/k8s/" class="tag-list-link" rel="5">k8s<span
               class="tag-list-count">5</span></a>
            
            
            <a href="https://wymli.github.io/tags/kafka/" class="tag-list-link" rel="5">kafka<span
               class="tag-list-count">5</span></a>
            
            
            <a href="https://wymli.github.io/tags/llm/" class="tag-list-link" rel="1">llm<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/lsh/" class="tag-list-link" rel="1">lsh<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/net/" class="tag-list-link" rel="1">net<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/oauth2/" class="tag-list-link" rel="1">oauth2<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/oci/" class="tag-list-link" rel="5">oci<span
               class="tag-list-count">5</span></a>
            
            
            <a href="https://wymli.github.io/tags/other/" class="tag-list-link" rel="2">other<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/overlayfs/" class="tag-list-link" rel="1">overlayfs<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/proc/" class="tag-list-link" rel="1">proc<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/python/" class="tag-list-link" rel="1">python<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/redis/" class="tag-list-link" rel="2">redis<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/rpc/" class="tag-list-link" rel="4">rpc<span
               class="tag-list-count">4</span></a>
            
            
            <a href="https://wymli.github.io/tags/runc/" class="tag-list-link" rel="2">runc<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/schedule/" class="tag-list-link" rel="1">schedule<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/scheduler/" class="tag-list-link" rel="1">scheduler<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/script/" class="tag-list-link" rel="1">script<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/server/" class="tag-list-link" rel="3">server<span
               class="tag-list-count">3</span></a>
            
            
            <a href="https://wymli.github.io/tags/socket/" class="tag-list-link" rel="1">socket<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/sys/" class="tag-list-link" rel="2">sys<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/taskqueue/" class="tag-list-link" rel="1">taskqueue<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/temporal/" class="tag-list-link" rel="1">temporal<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/tensorflow/" class="tag-list-link" rel="1">tensorflow<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/todo/" class="tag-list-link" rel="1">todo<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/underthehood/" class="tag-list-link" rel="1">underthehood<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/ut/" class="tag-list-link" rel="1">ut<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/uv/" class="tag-list-link" rel="1">uv<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/volcano/" class="tag-list-link" rel="2">volcano<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/vue/" class="tag-list-link" rel="2">vue<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/workflow/" class="tag-list-link" rel="2">workflow<span
               class="tag-list-count">2</span></a>
            
            
            <a href="https://wymli.github.io/tags/wsl/" class="tag-list-link" rel="1">wsl<span
               class="tag-list-count">1</span></a>
            
            
            <a href="https://wymli.github.io/tags/zookeeper/" class="tag-list-link" rel="1">zookeeper<span
               class="tag-list-count">1</span></a>
            
    </div>
<script>
document.onreadystatechange = () => {
  if (document.readyState === 'complete') {
    tagCloud('#tag-cloud-list a',  8 ,  20 );
  }
};

function tagCloud(where, min, max) {
  let iMax = 0;
  let iMin = 0;
  $(where).each(function() {
    let weight = Number($(this).attr("rel"));
    if(iMax < weight) iMax = weight;
    if(iMin > weight || iMin == 0) iMin = weight;
  });
  let step = (max - min)/(iMax - iMin);
  $(where).each(function() {
    let weight = $(this).attr("rel") - iMin;
    $(this).css({"font-size": min + (weight * step) + 'px'});
  });
};
</script>
</div>

      <div class="widget">
    <h3 class="widget-title"> Categories</h3>
    <div class="widget-body">
        <ul class="category-list">
            <li class="category-list-item"><a href="https://wymli.github.io/categories/ai-agent/" class="category-list-link">ai agent</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/algorithm/" class="category-list-link">algorithm</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/arch/" class="category-list-link">arch</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/argo/" class="category-list-link">argo</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/atomic/" class="category-list-link">atomic</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/bigdata/" class="category-list-link">bigdata</a><span class="category-list-count">3</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/bytedance/" class="category-list-link">bytedance</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/c/" class="category-list-link">c</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/cache/" class="category-list-link">cache</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/cli/" class="category-list-link">cli</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/concurrency/" class="category-list-link">concurrency</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/configcenter/" class="category-list-link">configcenter</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/container/" class="category-list-link">container</a><span class="category-list-count">6</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/database/" class="category-list-link">database</a><span class="category-list-count">4</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/datamining/" class="category-list-link">datamining</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/datastructure/" class="category-list-link">datastructure</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/db/" class="category-list-link">db</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/deploy/" class="category-list-link">deploy</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/distribute/" class="category-list-link">distribute</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/golang/" class="category-list-link">golang</a><span class="category-list-count">20</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/gpu/" class="category-list-link">gpu</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/http/" class="category-list-link">http</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/install/" class="category-list-link">install</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/interview/" class="category-list-link">interview</a><span class="category-list-count">3</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/js/" class="category-list-link">js</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/k8s/" class="category-list-link">k8s</a><span class="category-list-count">5</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/linux/" class="category-list-link">linux</a><span class="category-list-count">3</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/llm/" class="category-list-link">llm</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/messagequeue/" class="category-list-link">messagequeue</a><span class="category-list-count">5</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/net/" class="category-list-link">net</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/os/" class="category-list-link">os</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/os-memory/" class="category-list-link">os-memory</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/other/" class="category-list-link">other</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/protocal/" class="category-list-link">protocal</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/protocol/" class="category-list-link">protocol</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/python/" class="category-list-link">python</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/redis/" class="category-list-link">redis</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/rpc/" class="category-list-link">rpc</a><span class="category-list-count">4</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/script/" class="category-list-link">script</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/sys/" class="category-list-link">sys</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/taskqueue/" class="category-list-link">taskqueue</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/tensorflow/" class="category-list-link">tensorflow</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/todo/" class="category-list-link">todo</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/underthehood/" class="category-list-link">underthehood</a><span class="category-list-count">1</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/volcano/" class="category-list-link">volcano</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/vue/" class="category-list-link">vue</a><span class="category-list-count">2</span></li>
            <li class="category-list-item"><a href="https://wymli.github.io/categories/workflow/" class="category-list-link">workflow</a><span class="category-list-count">2</span></li>
        </ul>
    </div>
</div>
      <div class="widget">
    <h3 class="widget-title"> Tags</h3>
    <div class="widget-body">
        <ul class="tag-list">
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/ai-agent/" class="tag-list-link">ai agent</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/airflow/" class="tag-list-link">airflow</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/algorithm/" class="tag-list-link">algorithm</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/arch/" class="tag-list-link">arch</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/argo/" class="tag-list-link">argo</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/atomic/" class="tag-list-link">atomic</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/bigdata/" class="tag-list-link">bigdata</a><span
                    class="tag-list-count">3</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/bytedance/" class="tag-list-link">bytedance</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/c/" class="tag-list-link">c</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/cache/" class="tag-list-link">cache</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/cli/" class="tag-list-link">cli</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/concurrency/" class="tag-list-link">concurrency</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/container/" class="tag-list-link">container</a><span
                    class="tag-list-count">6</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/containerd/" class="tag-list-link">containerd</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/database/" class="tag-list-link">database</a><span
                    class="tag-list-count">4</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/datamining/" class="tag-list-link">datamining</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/datastructure/" class="tag-list-link">datastructure</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/db/" class="tag-list-link">db</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/deploy/" class="tag-list-link">deploy</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/designpattern/" class="tag-list-link">designpattern</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/distribute/" class="tag-list-link">distribute</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/eino/" class="tag-list-link">eino</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/epoll/" class="tag-list-link">epoll</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/event-stream/" class="tag-list-link">event-stream</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/golang/" class="tag-list-link">golang</a><span
                    class="tag-list-count">20</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/gpu/" class="tag-list-link">gpu</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/http/" class="tag-list-link">http</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/interview/" class="tag-list-link">interview</a><span
                    class="tag-list-count">3</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/js/" class="tag-list-link">js</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/k8s/" class="tag-list-link">k8s</a><span
                    class="tag-list-count">5</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/kafka/" class="tag-list-link">kafka</a><span
                    class="tag-list-count">5</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/llm/" class="tag-list-link">llm</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/lsh/" class="tag-list-link">lsh</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/net/" class="tag-list-link">net</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/oauth2/" class="tag-list-link">oauth2</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/oci/" class="tag-list-link">oci</a><span
                    class="tag-list-count">5</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/other/" class="tag-list-link">other</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/overlayfs/" class="tag-list-link">overlayfs</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/proc/" class="tag-list-link">proc</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/python/" class="tag-list-link">python</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/redis/" class="tag-list-link">redis</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/rpc/" class="tag-list-link">rpc</a><span
                    class="tag-list-count">4</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/runc/" class="tag-list-link">runc</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/schedule/" class="tag-list-link">schedule</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/scheduler/" class="tag-list-link">scheduler</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/script/" class="tag-list-link">script</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/server/" class="tag-list-link">server</a><span
                    class="tag-list-count">3</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/socket/" class="tag-list-link">socket</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/sys/" class="tag-list-link">sys</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/taskqueue/" class="tag-list-link">taskqueue</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/temporal/" class="tag-list-link">temporal</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/tensorflow/" class="tag-list-link">tensorflow</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/todo/" class="tag-list-link">todo</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/underthehood/" class="tag-list-link">underthehood</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/ut/" class="tag-list-link">ut</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/uv/" class="tag-list-link">uv</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/volcano/" class="tag-list-link">volcano</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/vue/" class="tag-list-link">vue</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/workflow/" class="tag-list-link">workflow</a><span
                    class="tag-list-count">2</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/wsl/" class="tag-list-link">wsl</a><span
                    class="tag-list-count">1</span></li>
            
            
            <li class="tag-list-item"><a href="https://wymli.github.io/tags/zookeeper/" class="tag-list-link">zookeeper</a><span
                    class="tag-list-count">1</span></li>
            
        </ul>

    </div>
</div>
      
<div class="widget">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget-body">
        <ul class="recent-post-list list-unstyled no-thumbnail">
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2021/04/a1underthehood-underthehood/" class="title">[UnderTheHood] Âü∫Á°Ä-ÈáçË¶Å-Áü•ËØÜ-ÊïôÊó®-Ê†ºË®Ä-Ëùâ</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2021-04-10 00:00:00 &#43;0000 UTC" itemprop="datePublished">2021-04-10</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2025/06/learning-redis-datastructure/" class="title">Learning: Redis DataStructure</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2025-06-12 00:00:00 &#43;0000 UTC" itemprop="datePublished">2025-06-12</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2025/06/gpu-learning-gpu-patitioning-and-nvidia-gpu-operator/" class="title">Learning: GPU Patitioning and NVIDIA GPU Operator</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2025-06-09 00:00:00 &#43;0000 UTC" itemprop="datePublished">2025-06-09</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2025/06/argo-learning-argo/" class="title">[argo] Learning: Argo</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2025-06-07 00:00:00 &#43;0000 UTC" itemprop="datePublished">2025-06-07</time>
                    </p>
                </div>
            </li>
            <li>
                <div class="item-inner">
                    <p class="item-title">
                        <a href="https://wymli.github.io/2025/05/js-javascript-is-all-you-need/" class="title">JS: Javascript is all you need</a>
                    </p>
                    <p class="item-date">
                        <time datetime="2025-05-30 00:00:00 &#43;0000 UTC" itemprop="datePublished">2025-05-30</time>
                    </p>
                </div>
            </li>
        </ul>
    </div>
</div>
  </div>
</aside>

    
    
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <h4 class="toc-title">Catalogue</h4>
    <nav id="toc" class="js-toc toc">

    </nav>
  </div>
</aside>
<main class="main" role="main"><div class="content">
  <article id="-" class="article article-type-" itemscope
    itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      <h1 itemprop="name">
  <a
    class="article-title"
    href="/2022/04/big-data-spark/"
    >[BigData] spark</a
  >
</h1>

      <div class="article-meta">
        
<span class="article-date">
  <i class="icon icon-calendar-check"></i>&nbsp;
<a href="https://wymli.github.io/2022/04/big-data-spark/" class="article-date">
  <time datetime="2022-04-15 00:00:00 &#43;0000 UTC" itemprop="datePublished">2022-04-15</time>
</a>
</span>
<span class="article-category">
  <i class="icon icon-folder"></i>&nbsp;
  <a class="article-category-link" href="/categories/bigdata/"> BigData </a>
</span>  
  <span class="article-tag">
    <i class="icon icon-tags"></i>&nbsp;
    <a class="article-tag-link" href="/tags/bigdata/"> BigData </a>
  </span>

		<span class="post-wordcount hidden-xs" itemprop="wordCount">Word Count: 4802 words</span>
		<span class="post-readcount hidden-xs" itemprop="timeRequired">Read Time: 10 minutes </span>
      </div>
    </div>
    <div class="article-entry marked-body js-toc-content" itemprop="articleBody">
      <h1 id="spark">Spark</h1>
<ul>
<li>Âπ∂Ë°åËÆ°ÁÆóÊ°ÜÊû∂</li>
<li>ÊîØÊåÅÊµÅÂºèÊàñÊâπÂºè</li>
<li>sparkÊèê‰∫§Êúâ‰∏Ä‰∏™ÂçïÁã¨ÁöÑspark-commit.shËÑöÊú¨</li>
<li>ÊâπÂ§ÑÁêÜÊòØspark core</li>
<li>ÊµÅÂ§ÑÁêÜÊòØspark streamingÔºåËøôÈáåÁöÑÊµÅÂú®ÂÆûÁé∞‰∏äÊòØ‰ºö‰º†ÂÖ•‰∏Ä‰∏™Á™óÂè£Â§ßÂ∞èÂíå‰∏ã‰∏Ä‰∏™Á™óÂè£ÁöÑ‰ΩçÁßªÔºåÊù•‰∫ßÁîüRDDÔºå‰∏Ä‰∏™RDDÂ∞±ÊòØ‰∏Ä‰∏™Á™óÂè£ÁöÑÂ∞èÊâπÊ¨°Êï∞ÊçÆÔºåÊâÄ‰ª•spark streamingÂè™ÊòØÂú®ÊâπÂºèspark core‰∏äÂåÖË£Ö‰∫Ü‰∏Ä‰∏ã„ÄÇ</li>
</ul>
<h2 id="ÊâßË°åÊµÅÁ®ã">ÊâßË°åÊµÅÁ®ã</h2>
<p>‰∏Ä‰∏™spark Â∫îÁî®ÁöÑÊµÅÁ®ãÊòØËøôÊ†∑ÁöÑÔºö</p>
<ol>
<li>ÂàõÂª∫sparkcontextÁ±ª</li>
</ol>
<pre><code class="language-python">from pyspark.conf import SparkConf
from pyspark.context import SparkContext
conf = SparkConf()
conf.setMaster(&quot;local&quot;).setAppName(&quot;My app&quot;) &lt;- ËøôÈáåmasterÊòØlocalÔºåË°®Á§∫Êú¨Âú∞Ê®°ÂºèÔºå‰∏ÄËà¨ÊòØlocal[N],Ë°®Á§∫N‰∏™Á∫øÁ®ã„ÄÇ‰πüÂèØ‰ª•ÊòØspark standaloneÊàñyarn
sc = SparkContext(conf=conf)
# ÊàñÁõ¥Êé• sc = SparkContext('local', 'my app')
</code></pre>
<ol start="2">
<li>sparkcontextÂÆû‰æãË∞ÉÁî®ÂêÑÁßçÊï∞ÊçÆËæìÂÖ•ÊñπÊ≥ïÔºåÁîüÊàêRDD„ÄÇÂÖ∏ÂûãÁöÑÊï∞ÊçÆËæìÂÖ•ÊòØhdfsÔºåÊ†ºÂºèÊòØtextÔºåÊØîÂ¶Ç</li>
</ol>
<pre><code class="language-python"># ‰ªéhdfsËØªÂèñtextfile
lines = sc.textFile(&quot;hdfs://hadoop102:9000/fruit.txt&quot;)
print(lines.collect()) # rdd.collect(): Return a list that contains all of the elements in this RDD.
</code></pre>
<ol start="3">
<li>ÊâßË°åtransformationÁÆóÂ≠êÔºåËøôÁßçÁÆóÂ≠êÁöÑÂÖ∏Âûã‰ª£Ë°®Â∞±ÊòØmapÔºåflatmapÔºåfilterÔºådistinctÔºåunionÔºåreduceByKeyÁ≠â</li>
</ol>
<pre><code class="language-python">from operator import add
res = lines.flatmap(lambda x: x.split(&quot;,&quot;)).map(lambda x: (x,1)).reduceByKey(add)
# rdd.flatmap: Return a new RDD by first applying a function to all elements of this RDD, and then flattening the results. ÂÖ∏ÂûãÁöÑ‰æãÂ≠êÂ∞±ÊòØÂ∞Ü‰∏ÄË°åËΩ¨ÊàêÂçïËØçÔºåÊúÄÁªà‰ªéË°åÁöÑÂàóË°®ÂèòÊàêÂçïËØçÁöÑÂàóË°®„ÄÇ
# rdd.map: Return a new RDD by applying a function to each element of this RDD. ÂÖ∏ÂûãÁöÑ‰æãÂ≠êÂ∞±ÊòØÂ∞ÜÂçïËØçÂèòÊàêÂ∏¶ËÆ°Êï∞ÔºåÂç≥apple =&gt; (apple, 1)
# rdd.reduceByKey: Merge the values for each key using an associative and commutative reduce function. Á±ª‰ººMR‰∏≠ÁöÑCombiner„ÄÇËøôÈáåreduceByKeyÈúÄË¶Å‰º†ÂÖ•ÁöÑÊòØÈíàÂØπÁõ∏ÂêåkeyÁöÑreduceÂáΩÊï∞„ÄÇÊâÄË∞ìÁöÑkeyÂ∞±ÊòØpair RDD‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂç≥‰∫åÂÖÉÁªÑx‰∏≠ÁöÑx[0]ÔºåÊç¢Âè•ËØùËØ¥ÔºåÁªèËøámapÂêéRDDËá™Âä®ÂèòÊàê‰∫ÜPair RDD„ÄÇËÄåÊâÄË∞ìÁöÑreduceÂáΩÊï∞ÁöÑËøêË°åÊú∫Âà∂Â∞±ÊòØÔºöÂ∞ÜRDDÁöÑÂÖÉÁ¥†‰∏§‰∏§‰º†ÂÖ•ÂáΩÊï∞ÔºåËøîÂõû‰∏Ä‰∏™Êñ∞ÂÖÉÁ¥†ÔºåÂπ∂Â∞ÜÊñ∞ÂÖÉÁ¥†Âíå‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†ÂÜç‰∏ÄËµ∑‰∏§‰∏§‰º†ÂÖ•ÂáΩÊï∞ÔºåÁõ¥Âà∞Âè™Ââ©‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†„ÄÇ reduceByKeyÊòØKeyËåÉÂõ¥ÂÜÖÁöÑreduce„ÄÇËÆ°ÁÆóÊú∫Âà∂ÂíåfoldÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ
# ËøôÈáåÁöÑoperator.add Á≠â‰ª∑‰∫é lambda a,b: a+b
</code></pre>
<ol start="4">
<li>ÊâßË°åactionÁÆóÂ≠êÔºåËøôÁßçÁÆóÂ≠êÁöÑÂÖ∏Âûã‰ª£Ë°®ÊòØreduce,foreachÔºåsaveAsTextFileÔºåcollectÔºåcountÔºåtopÁ≠â</li>
</ol>
<pre><code class="language-python">res.saveAsTextFile(&quot;hdfs://...&quot;)
sc.stop()
</code></pre>
<ol start="5">
<li>ÊâßË°åactionÁÆóÂ≠êÂ∞±ÊÑèÂë≥Êèê‰∫§job</li>
</ol>
<h2 id="ÂêçËØçËß£Èáä">ÂêçËØçËß£Èáä</h2>
<p><a href="https://www.jianshu.com/p/3aa52ee3a802">cite</a>
‰ªªÂä°ËßÜËßíÔºö</p>
<ul>
<li>ApplicationÔºöÁî®Êà∑ÊâãÂÜôÂÆö‰πâÁöÑÂ∫îÁî®Ôºå‰∏Ä‰∏™sparkcontextÂ∞±ÊòØ‰∏Ä‰∏™sparkÁ®ãÂ∫èÔºåÁî®Êà∑ÁºñÂÜôÁöÑSparkÂ∫îÁî®Á®ãÂ∫è,ÂåÖÊã¨‰∏Ä‰∏™DriverÂíåÂ§ö‰∏™executors„ÄÇ</li>
<li>JobÔºö‰∏Ä‰∏™spark appÂåÖÂê´‰∏Ä‰∏™ÊàñÂ§ö‰∏™JobÔºåÊØèÈÅáÂà∞‰∏Ä‰∏™RDDÁöÑActionÊìç‰ΩúÂ∞±ÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑJob„ÄÇ</li>
<li>StageÔºö‰∏Ä‰∏™JobÂàÜ‰∏∫‰∏Ä‰∏™ÊàñÂ§ö‰∏™StageÔºåÂêÑ‰∏™stage‰πãÈó¥ÊåâÁÖßÈ°∫Â∫èÊâßË°å„ÄÇ</li>
<li>TaskÔºöTaskÊòØË¢´ÂàÜÈÖçÂà∞‰∏Ä‰∏™Executor‰∏äÁöÑËÆ°ÁÆóÂçïÂÖÉÔºå ‰∏Ä‰∏™StageÂàÜ‰∏∫Â§ö‰∏™Task„ÄÇTaskÊâßË°åÁõ∏ÂêåÁöÑÁ®ãÂ∫èÈÄªËæëÔºåÂè™ÊòØÂÆÉ‰ª¨Êìç‰ΩúÁöÑÊï∞ÊçÆ‰∏çÂêå„ÄÇ‰∏ÄËà¨RDDÁöÑ‰∏Ä‰∏™PartitionÂØπÂ∫î‰∏Ä‰∏™Task„ÄÇStageÂ∞ÜÂàíÂàÜÊàêÂ§ö‰∏™<code>ÂèØ‰ª•Âπ∂Ë°åËÆ°ÁÆóÁöÑ</code>Task„ÄÇ</li>
</ul>
<p>ËøõÁ®ãÔºö</p>
<ul>
<li>Driver: ËøêË°åmain()ÂáΩÊï∞Âπ∂ÂàõÂª∫SparkContextËøõÁ®ã„ÄÇÊØîÂ¶ÇÁî±driverËøõÁ®ãÊâßË°åtopÂáΩÊï∞ËøõË°åÂÜÖÂ≠òÊéíÂ∫è</li>
<li>ExecutorÔºöËøêË°åÂú®worker node‰∏äÊâßË°åÂÖ∑‰ΩìÁöÑËÆ°ÁÆó‰ªªÂä°ÔºåÂ≠òÂÇ®Êï∞ÊçÆÁöÑËøõÁ®ã</li>
</ul>
<p>Êï∞ÊçÆËßÜËßíÔºö</p>
<ul>
<li>RDD -&gt; partition -&gt; record.   PartitionÊòØSparkËøõË°åÊï∞ÊçÆÂ§ÑÁêÜÁöÑÂü∫Êú¨Âçï‰ΩçÔºå‰∏ÄËà¨Êù•ËØ¥‰∏Ä‰∏™PartitionÂØπÂ∫î‰∏Ä‰∏™TaskÔºåËÄå‰∏Ä‰∏™Partition‰∏≠ÈÄöÂ∏∏ÂåÖÂê´Êï∞ÊçÆÈõÜ‰∏≠ÁöÑÂ§öÊù°ËÆ∞ÂΩï(Record)Ôºå‰∏Ä‰∏™RDDÂåÖÊã¨Â§ö‰∏™Partition„ÄÇ</li>
</ul>
<h3 id="ÂÆΩÁ™Ñ‰æùËµñ">ÂÆΩÁ™Ñ‰æùËµñ</h3>
<p>Spark‰∏≠RDDÁöÑÈ´òÊïà‰∏éDAGÔºàÊúâÂêëÊó†ÁéØÂõæÔºâÊúâÂæàÂ§ßÁöÑÂÖ≥Á≥ªÔºåÂú®DAGË∞ÉÂ∫¶‰∏≠ÈúÄË¶ÅÂØπËÆ°ÁÆóÁöÑËøáÁ®ãÂàíÂàÜStageÔºåÂàíÂàÜÁöÑ‰æùÊçÆÂ∞±ÊòØRDD‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ª„ÄÇRDD‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ªÂàÜ‰∏∫‰∏§ÁßçÔºåÂÆΩ‰æùËµñ(wide dependency/shuffle dependency)ÂíåÁ™Ñ‰æùËµñÔºànarrow dependencyÔºâ</p>
<p>Á™Ñ‰æùËµñÂ∞±ÊòØÊåáÁà∂RDDÁöÑÊØè‰∏™ÂàÜÂå∫Âè™Ë¢´‰∏Ä‰∏™Â≠êRDDÂàÜÂå∫‰ΩøÁî®ÔºåÂ≠êRDDÂàÜÂå∫ÈÄöÂ∏∏Âè™ÂØπÂ∫îÂ∏∏Êï∞‰∏™Áà∂RDDÂàÜÂå∫ÔºåÂÖ∏ÂûãÁöÑÂ¶ÇmapÔºåfilterÔºåunionÔºàÂ∏∏Êï∞‰∏™Áà∂RDDÔºâ
ÂÆΩ‰æùËµñÂ∞±ÊòØÊåáÁà∂RDDÁöÑÊØè‰∏™ÂàÜÂå∫ÈÉΩÊúâÂèØËÉΩË¢´Â§ö‰∏™Â≠êRDDÂàÜÂå∫‰ΩøÁî®ÔºåÂ≠êRDDÂàÜÂå∫ÈÄöÂ∏∏ÂØπÂ∫îÁà∂RDDÊâÄÊúâÂàÜÂå∫ÔºåÂÖ∏ÂûãÁöÑÂ¶ÇgroupByKey</p>
<p>Ê≥®ÊÑè‰∏äÈù¢ÊâÄËØ¥ÁöÑÂàÜÂå∫ÔºåÊòØRDD-&gt;Partition-&gt;Record Ëøô‰∏™ÂÖ≥Á≥ªÈáåÁöÑÂàÜÂå∫„ÄÇÂú®Spark‰∏≠‰ª•Partition‰∏∫Âçï‰ΩçËøõË°åÊìç‰Ωú„ÄÇÂú®ÂØπstage‰ªéÂêéÂæÄÂâçÊãìÂ±ïÊó∂ÔºåÈÅáÂà∞Á™Ñ‰æùËµñÂ∞±Â∞ÜÂÖ∂Âä†ÂÖ•stageÔºåÈÅáÂà∞ÂÆΩ‰æùËµñÂ∞±Êñ≠ÂºÄÔºåÈáçÊñ∞ÊòØ‰∏Ä‰∏™stage„ÄÇ</p>
<h3 id="transformation-ÁÆóÂ≠êÂíåaction-ÁÆóÂ≠êÁöÑÂå∫Âà´">transformation ÁÆóÂ≠êÂíåaction ÁÆóÂ≠êÁöÑÂå∫Âà´</h3>
<p>TransformationÊòØlazyÁöÑÔºåÁî®‰∫éÂÆö‰πâÊñ∞ÁöÑRDDÔºõËÄåActionÂêØÂä®ËÆ°ÁÆóÊìç‰ΩúÔºåÊèê‰∫§‰∏Ä‰∏™JobÔºåÂπ∂ÂêëÁî®Êà∑Á®ãÂ∫èÔºàdriverÔºåyarnÁöÑappMasterÔºâËøîÂõûÂÄºÊàñÂêëÂ§ñÈÉ®Â≠òÂÇ®ÂÜôÊï∞ÊçÆ</p>
<h2 id="ÈÉ®ÁΩ≤ÊñπÂºè">ÈÉ®ÁΩ≤ÊñπÂºè</h2>
<p>Êàë‰ª¨ÈúÄË¶Åcluster managerÊù•ÁÆ°ÁêÜÊú∫Âô®Ôºå‰∏çÂêåÁöÑcluster managerÂ∞±ÊòØ‰∏çÂêåÁöÑÈÉ®ÁΩ≤ÊñπÂºè</p>
<h3 id="spark-standalone">spark standalone</h3>
<p>ËøôÈáåstandaloneÂ∞±ÊòØÈÄöËøá‰∏ÄÁßçÂéüÁîüÁöÑÈùûÂ∏∏plainÁöÑÊñπÂºèÁÆ°ÁêÜÊú∫Âô®ÔºåÂç≥Âú®ÂØπÂ∫îÁöÑËäÇÁÇπ‰∏äÊâãÂä®ÂêØÂä®ÁÆ°ÁêÜËøõÁ®ã„ÄÇÊØîÂ¶ÇÂú®masterÊú∫Âô®‰∏äÂêØÂä®./sbin/start-master.shÔºåÂú®workerÊú∫Âô®‰∏äÂêØÂä®./sbin/start-worker.sh„ÄÇËøôÊ†∑ÔºåÊú∫Âô®Â∞±Âä†ÂÖ•‰∫ÜsparkÈõÜÁæ§„ÄÇ</p>
<h3 id="spark-on-yarn">spark on yarn</h3>
<p>ÂâçÈù¢spark standaloneÁöÑÊñπÂºèÊØîËæÉÁ¨®‰∏îÁπÅÁêêÔºåÂ¶ÇÊûúÊúâÂæàÂ§öÊú∫Âô®ÔºåÊúâÂæàÂ§öÁ±ª‰ººsparkËøôÊ†∑ÁöÑÂàÜÂ∏ÉÂºèÈõÜÁæ§Â∫îÁî®ÔºåÈÇ£ÊØèÂè∞Êú∫Âô®ÈÉΩË¶ÅÊâãÂä®ËøêË°å‰∏Ä‰∏ãÂØπÂ∫îÁöÑmanager processÔºåÂæàÈ∫ªÁÉ¶„ÄÇ<br>
yarnÁªôÂá∫‰∫Ü‰∏ÄÁßçÁªü‰∏ÄÁöÑÁÆ°ÁêÜÊú∫Âô®ÁöÑÊñπÂºèÔºåÊîØÊåÅÂ§öÁßçÂàÜÂ∏ÉÂºèÈõÜÁæ§Â∫îÁî®ÔºåÊØîÂ¶ÇsparkÔºåflinkËøô‰∫õÂ§ßÊï∞ÊçÆÂú∫ÊôØÂ∫îÁî®„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÊòØÂ∞ÜÊú∫Âô®‰∏äÁöÑspark-workerËøõÁ®ãÊç¢Êàê‰∫ÜyarnÁöÑnodeManagerËøõÁ®ãÔºåËÄåËøôÁßçnodeManagerËøõÁ®ã‰∏ç‰ªÖÊîØÊåÅsparkÔºåËøòÊîØÊåÅflinkÁ≠â„ÄÇ<br>
ÂØπ‰∫éspark on yarnÔºåÂ∞±ËÆ©yarnÂ∏ÆÂä©Êàë‰ª¨ÁÆ°ÁêÜÊú∫Âô®ÔºåÊâÄË∞ìÁöÑÁÆ°ÁêÜÊú∫Âô®Âë¢ÔºåÊàëÁöÑÁêÜËß£Â∞±ÊòØÂ§ÑÂú®ÂØπÂ∫îÊú∫Âô®‰∏äËøêË°åÁöÑÁÆ°ÁêÜËøõÁ®ã‰Ωú‰∏∫‰∏Ä‰∏™‰ª£ÁêÜÔºåÊòØËÉΩÂ§üÂ∏Æ‰Ω†ÂàÜÈÖçËµÑÊ∫êÔºåÂêØÂä®ËøõÁ®ãÁ≠âÁ≠â„ÄÇÊ≠§Êó∂ÔºådriverÂ∞±ÊòØyarnÁöÑAppMaster„ÄÇ</p>
<h4 id="ËØ¶ÁªÜÊµÅÁ®ã">ËØ¶ÁªÜÊµÅÁ®ã</h4>
<p>yarnÈõÜÁæ§Ê®°Âºè‰∏∫‰æãÔºåÈÉ®ÁΩ≤Ê®°Âºè‰πüÊòØclusterÔºõÂèÇËÄÉ <a href="https://cangchen.blog.csdn.net/article/details/120278516">here</a></p>
<blockquote>
<p>spark deployÈÉ®ÁΩ≤ÈÉ®ÂàÜÁöÑ‰ª£Á†ÅÂú®<a href="https://github.com/apache/spark/tree/master/core/src/main/scala/org/apache/spark/deploy">Ê≠§Â§Ñ</a></p></blockquote>
<ol>
<li>spark-submit.sh <a href="https://github.com/apache/spark/tree/master/sbin">ËÑöÊú¨</a>ÂºÄÂßãÊèê‰∫§ÔºåÂèÇÊï∞masterÊåáÂÆöyarnÔºåjava‰ª£Á†ÅÊåáÂÆöjarÂåÖ&ndash;jarÂíå‰∏ªÁ±ªÂêç&ndash;classÔºàmainÂáΩÊï∞Âú®ÁöÑÁ±ªÔºåËøôÂíåjavaËøêË°åÊú∫Âà∂Áõ∏ÂÖ≥ÔºâÔºåÂÖ∂‰ªñËØ≠Ë®ÄÂ¶Çpython/rÔºåÂè™Ë¶ÅÊåáÂÆöÊñá‰ª∂Âç≥ÂèØ</li>
<li>spark-submit.sh ËÑöÊú¨Ë∞ÉÁî®scala org.apache.spark.deploy.SparkSubmitÁ±ªÔºå‰∏ãÁß∞‰πã‰∏∫SparkSubmitËøõÁ®ã</li>
<li>Ê†πÊçÆË∞ÉÁî®ÂèÇÊï∞&ndash;deploy=cluster,&ndash;master=yarnÔºåÁé∞Âú®Ë∞ÉÁî®org.apache.spark.deploy.yarn.YarnClusterApplicationÔºå</li>
<li>SparkSubmitËøõÁ®ãÂàõÂª∫‰∏Ä‰∏™YarnClientÔºåÊèê‰∫§ApplicationÁªôyarnÈõÜÁæ§ÁöÑResourceManagerÔºåÊèê‰∫§ÊàêÂäüÂêéËøîÂõûappidÔºåÂ¶ÇÊûúspark.submit.deployMode=cluster&amp;&amp;spark.yarn.submit.waitAppCompletion=trueÔºå SparkSubmitËøõÁ®ã‰ºöÂÆöÊúüËæìÂá∫appIdÊó•ÂøóÁõ¥Âà∞‰ªªÂä°ÁªìÊùü(monitorApplication(appId))ÔºåÂê¶Âàô‰ºöËæìÂá∫‰∏ÄÊ¨°Êó•ÂøóÁÑ∂ÂêéÈÄÄÂá∫„ÄÇ
<ol>
<li>ËøôÂ∞±ÊòØdeploy=clusterÊ®°ÂºèÔºåÂ¶ÇÊûúÊòØdeploy=clientÊ®°ÂºèÔºåÂ∞±‰∏çÈúÄË¶ÅÊèê‰∫§„ÄÇ</li>
</ol>
</li>
<li>YarnClientÈÄöËøáÊèê‰∫§ApplicationÁöÑËøáÁ®ã</li>
</ol>
<pre><code class="language-scala">launcherBackend.connect()
yarnClient.init(hadoopConf)
yarnClient.start()

logInfo(&quot;Requesting a new application from cluster with %d NodeManagers&quot;
  .format(yarnClient.getYarnClusterMetrics.getNumNodeManagers))

// Get a new application from our RM
val newApp = yarnClient.createApplication()
val newAppResponse = newApp.getNewApplicationResponse()
appId = newAppResponse.getApplicationId()

// The app staging dir based on the STAGING_DIR configuration if configured
// otherwise based on the users home directory.
val appStagingBaseDir = sparkConf.get(STAGING_DIR)
  .map { new Path(_, UserGroupInformation.getCurrentUser.getShortUserName) }
  .getOrElse(FileSystem.get(hadoopConf).getHomeDirectory())
stagingDirPath = new Path(appStagingBaseDir, getAppStagingDir(appId))

new CallerContext(&quot;CLIENT&quot;, sparkConf.get(APP_CALLER_CONTEXT),
  Option(appId.toString)).setCurrentContext()

// Verify whether the cluster has enough resources for our AM
verifyClusterResources(newAppResponse)

// Set up the appropriate contexts to launch our AM
val containerContext = createContainerLaunchContext(newAppResponse)
val appContext = createApplicationSubmissionContext(newApp, containerContext)

// Finally, submit and monitor the application
logInfo(s&quot;Submitting application $appId to ResourceManager&quot;)
yarnClient.submitApplication(appContext)
launcherBackend.setAppId(appId.toString)
reportLauncherState(SparkAppHandle.State.SUBMITTED)
</code></pre>
<ol start="6">
<li>Âú®Êèê‰∫§Â∫îÁî®Êó∂ÔºåyarnÂÆ¢Êà∑Á´ØÈ¶ñÂÖàË∞ÉÁî®yarn.createApplication()Ëé∑ÂèñnewAppResponseÔºàÂÖ∂‰∏≠ÂåÖÊã¨appIDÔºâÔºåÈöèÂêéÊûÑÂª∫ÂÆπÂô®ÂíåÂ∫îÁî®‰∏ä‰∏ãÊñáappContextÔºåÊúÄÁªàÊèê‰∫§Â∫îÁî®yarn.submitApplication(appContext)ÔºåyarnÂÆ¢Êà∑Á´ØÈÄöËøá‰º†ÂÖ•appContextÁúüÊ≠£Êèê‰∫§Â∫îÁî®„ÄÇappContextÂåÖÊã¨ÂÆπÂô®ÂêØÂä®‰∏ä‰∏ãÊñáÔºà<code>containerContext = createContainerLaunchContext(newAppResponse)</code>ÔºâÂíåÂ∫îÁî®Êèê‰∫§‰∏ä‰∏ãÊñáÔºà<code>appContext = createApplicationSubmissionContext(newApp,containerContext)</code>Ôºâ</li>
<li>Êàë‰ª¨Êù•ÁúãÊòØÂ¶Ç‰ΩïÊûÑÂª∫ÂÆπÂô®ÂêØÂä®‰∏ä‰∏ãÊñáÁöÑÔºåcreateContainerLaunchContext(newAppResponse)Ôºö</li>
</ol>
<pre><code class="language-scala">if (isClusterMode) {
  Utils.classForName(&quot;org.apache.spark.deploy.yarn.ApplicationMaster&quot;).getName
} else {
  Utils.classForName(&quot;org.apache.spark.deploy.yarn.ExecutorLauncher&quot;).getName
}
val commands = prefixEnv ++
      Seq(Environment.JAVA_HOME.$$() + &quot;/bin/java&quot;, &quot;-server&quot;) ++
      javaOpts ++ amArgs ++
      Seq(
        &quot;1&gt;&quot;, ApplicationConstants.LOG_DIR_EXPANSION_VAR + &quot;/stdout&quot;,
        &quot;2&gt;&quot;, ApplicationConstants.LOG_DIR_EXPANSION_VAR + &quot;/stderr&quot;)
</code></pre>
<p>ÂØπ‰∫édeploy=clusterÁöÑappMasterÁöÑÂÆπÂô®ÂêØÂä®ÂëΩ‰ª§ÁÆÄÂçïÊù•ÁúãÂ∞±ÊòØ<code>bin/java -server org.apache.spark.deploy.yarn.ApplicationMaster --class ‚Ä¶ --jar ...</code>
8. Â∫îÁî®ÈÄöËøáyarnClientÊèê‰∫§ÂêéÔºåyarnÈõÜÁæ§Êüê‰∏Ä‰∏™NodeManagerÊî∂Âà∞ResourceManagerÁöÑÂëΩ‰ª§ÔºåÂêØÂä®ApplicationMasterËøõÁ®ã„ÄÇApplicationMaster‰ºöÂêØÂä®driver„ÄÇ</p>
<pre><code class="language-scala">if (isClusterMode) {
  runDriver()
} else {
  runExecutorLauncher()
}
</code></pre>
<ol>
<li>‰∏ãÈù¢ÊòØrunDriver()ÁöÑÊµÅÁ®ãÔºåÂÖàÂè¶ÂêØÂä®‰∏Ä‰∏™Á∫øÁ®ãÈÄöËøáÂèçÂ∞ÑÊâßË°åÂëΩ‰ª§Ë°å‰∏≠-‚ÄìclassÊåáÂÆöÁöÑÁ±ªÔºàorg.apache.spark.examples.SparkPiÔºâ‰∏≠ÁöÑmainÂáΩÊï∞„ÄÇÂêåÊó∂Âú®‰∏ªÁ∫øÁ®ã‰ºöÂêëResourceManager‰Ωú‰∏∫AppMasterÊ≥®ÂÜåËá™Â∑±„ÄÇ</li>
</ol>
<pre><code class="language-scala">// 1. startUserApplication ÂêØÂä®Áî®Êà∑Â∫îÁî®main‰ª£Á†Å
val mainMethod = userClassLoader.loadClass(args.userClass)
      .getMethod(&quot;main&quot;, classOf[Array[String]])
val userThread = new Thread {
      override def run(): Unit = {
          mainMethod.invoke(null, userArgs.toArray)
      }
}
userThread.setContextClassLoader(userClassLoader)
userThread.setName(&quot;Driver&quot;)
userThread.start()

// 2. ÂêërmÊ≥®ÂÜåam
registerAM(host, port, userConf, sc.ui.map(_.webUrl), appAttemptId)
// 3. Áî≥ËØ∑exectorÁöÑËµÑÊ∫ê
createAllocator(driverRef, userConf, rpcEnv, appAttemptId, distCacheConf)
  // createAllocator()ÂáΩÊï∞ÂÜÖÈÉ®
  // 3.1 ÂàõÂª∫Áî≥ËØ∑ÂÆ¢Êà∑Á´Ø
  allocator = client.createAllocator(
      yarnConf,
      _sparkConf,
      appAttemptId,
      driverUrl,
      driverRef,
      securityMgr,
      localResources)
  // 3.2 Áî≥ËØ∑ËµÑÊ∫êÂπ∂Ê≤üÈÄöÂØπÂ∫îÁöÑnmÔºåÊâßË°åexectorÂÆπÂô®
  allocator.allocateResources()
    // allocateResources()ÂáΩÊï∞ÂÜÖÈÉ®
    // 3.2.1 Ëé∑Âèñcontainers
    val allocateResponse = amClient.allocate(progressIndicator)
    val allocatedContainers = allocateResponse.getAllocatedContainers()
    // 3.2.1 Á≠õÈÄâcontaienrsÔºåÊ†πÊçÆ‰∏ªÊú∫hostÔºåÊú∫Êû∂rackÁ≠â‰ø°ÊÅØÁ≠õÈÄâÂá∫Ë¶Å‰ΩøÁî®ÁöÑcontainers
    matchContainerToRequest(allocatedContainer, ANY_HOST, containersToUse,
        remainingAfterOffRackMatches)
    // 3.2.3 ÂêØÂä®ÂÆπÂô®
    runAllocatedContainers(containersToUse)
      // runAllocatedContainers()ÂÜÖÈÉ®
      // 3.2.3.1 Ë∞ÉÁî®ExecutorRunnable
      for (container &lt;- containersToUse) {
        new ExecutorRunnable(
                  Some(container),
                  conf,
                  sparkConf,
                  driverUrl,
                  executorId,
                  executorHostname,
                  executorMemory,
                  executorCores,
                  appAttemptId.getApplicationId.toString,
                  securityMgr,
                  localResources,
                  ResourceProfile.DEFAULT_RESOURCE_PROFILE_ID // use until fully supported
                ).run()
      }
      // 3.2.3.2 ÊâßË°åExecutorRunnable.run()ÊñπÊ≥ï,Ê≤üÈÄönodeManager
      def run(): Unit = {
        logDebug(&quot;Starting Executor Container&quot;)
        nmClient = NMClient.createNMClient()
        nmClient.init(conf)
        nmClient.start()
        startContainer()
      }
      def startContainer(){
        val commands = prepareCommand()
        ctx.setCommands(commands.asJava)

        nmClient.startContainer(container.get, ctx)
      }
      def prepareCommand(){
        val commands = prefixEnv ++
          Seq(Environment.JAVA_HOME.$$() + &quot;/bin/java&quot;, &quot;-server&quot;) ++
          javaOpts ++
          Seq(&quot;org.apache.spark.executor.YarnCoarseGrainedExecutorBackend&quot;,
            &quot;--driver-url&quot;, masterAddress,
            &quot;--executor-id&quot;, executorId,
            &quot;--hostname&quot;, hostname,
            &quot;--cores&quot;, executorCores.toString,
            &quot;--app-id&quot;, appId,
            &quot;--resourceProfileId&quot;, resourceProfileId.toString) ++
          userClassPath ++
          Seq(
            s&quot;1&gt;${ApplicationConstants.LOG_DIR_EXPANSION_VAR}/stdout&quot;,
            s&quot;2&gt;${ApplicationConstants.LOG_DIR_EXPANSION_VAR}/stderr&quot;)
      }

</code></pre>
<blockquote>
<p>Ëøô‰∏ÄÂ•óÊµÅÁ®ãËµ∞‰∏ãÊù•ÔºåÊàëËßâÂæóÂ∫îËØ•ÁúãÁúãyarnclient~ÔºåÂç≥ÊÄé‰πà‰∏éyarn‰∫§‰∫í„ÄÇ</p></blockquote>
<h2 id="Êèê‰∫§‰ªªÂä°">Êèê‰∫§‰ªªÂä°</h2>
<p><a href="https://spark.apache.org/docs/2.2.0/submitting-applications.html">https://spark.apache.org/docs/2.2.0/submitting-applications.html</a>
ÈÄöËøáÂêç‰∏∫spark-submit.shÁöÑËÑöÊú¨ÔºåÊåáÂÆömasterÁöÑÂú∞ÂùÄÂç≥ÂèØÊèê‰∫§Âà∞spark standaloneÊàñyarn„ÄÇ</p>
<h2 id="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</h2>
<ul>
<li>
<h2 id="application">application</h2>
</li>
<li>
<p>driver</p>
<ul>
<li>Spark applications run as independent sets of processes on a cluster, coordinated by the SparkContext object in your main program (called the driver program). spark applicationÊòØÁî®Êà∑Êèê‰∫§ÁöÑ‰Ωú‰∏ö</li>
<li>The driver program must listen for and accept incoming connections from its executors throughout its lifetime</li>
</ul>
</li>
<li>
<p>executor</p>
<ul>
<li>processes on worker node that run computations and store data for your application.</li>
<li>Each application gets its own executor processes, which stay up for the duration of the whole application and run tasks in multiple threads.</li>
</ul>
</li>
<li>
<p>task</p>
<ul>
<li>each driver schedules its own tasks</li>
<li>tasks from different applications run in different JVMs</li>
</ul>
</li>
<li>
<p>Specifically, to run on a cluster, the SparkContext can connect to several types of cluster managers (either Spark‚Äôs own standalone cluster manager, Mesos, YARN or Kubernetes), which allocate resources across applications. Once connected, Spark acquires executors on nodes in the cluster, which are processes that run computations and store data for your application. Next, it sends your application code (defined by JAR or Python files passed to SparkContext) to the executors. Finally, SparkContext sends tasks to the executors to run.</p>
</li>
<li>
<p>You can launch a standalone cluster ÔºåÊàñËÄÖÊòØrunning on the Mesos or YARN cluster managers</p>
</li>
<li>
<p>The standalone cluster mode currently only supports a simple FIFO scheduler across applications</p>
</li>
<li>
<p>‰∏Ä‰∏™applicationÊúâÂæàÂ§ö executors</p>
</li>
<li>
<p>Â∫îÁî®ÂêØÂä®Ê®°ÂºèÔºö For standalone clusters, Spark currently supports two modes. In client mode, the driver is launched in the same process as the client that submits the application. In cluster mode, however, the driver is launched from one of the Worker processes inside the cluster, and the client process exits as soon as it fulfills its responsibility of submitting the application without waiting for the application to finish.</p>
</li>
</ul>

    </div>
    <div class="article-footer">
<blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    <li class="post-copyright-link hidden-xs">
      <strong>Permalink: </strong>
      <a href="https://wymli.github.io/2022/04/big-data-spark/" title="[BigData] spark" target="_blank" rel="external">https://wymli.github.io/2022/04/big-data-spark/</a>
    </li>
    <li class="post-copyright-license">
      <strong>License: </strong>
        <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a>
    </li>
  </ul>
</blockquote>

<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/wymli" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="https://wymli.github.io/me.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/wymli" target="_blank"><span class="text-dark">Li Weiming</span><small class="ml-1x">wymli@sysu.cse</small></a></h3>
        <div>ONE CAN GO FAST</div>
      </div>
    </figure>
  </div>
</div>

    </div>
  </article>
</div><nav class="bar bar-footer clearfix" data-stick-bottom>
    <div class="bar-inner">
        <ul class="pager pull-left">
            <li class="prev">
                <a href="https://wymli.github.io/2022/04/big-data-hadoop%E7%9B%B8%E5%85%B3%E5%85%A5%E9%97%A8/" title="[BigData] Â§ßÊï∞ÊçÆÂÖ•Èó®"><i
                        class="icon icon-angle-left"
                        aria-hidden="true"></i><span>&nbsp;&nbsp;Older</span></a>
            </li>
            <li class="next">
                <a href="https://wymli.github.io/2022/04/big-data-yarn/"
                    title="[BigData] yarn client"><span>Newer&nbsp;&nbsp;</span><i
                        class="icon icon-angle-right" aria-hidden="true"></i></a>
            </li>
            
            <li class="toggle-toc">
                <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false"
                    title="Catalogue" role="button">
                    <span>[&nbsp;</span><span>Catalogue</span>
                    <i class="text-collapsed icon icon-anchor"></i>
                    <i class="text-in icon icon-close"></i>
                    <span>]</span>
                </a>
            </li>
        </ul>
        <div class="bar-right">
            <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter"
                data-mobile-sites="weibo,qq,qzone"></div>
        </div>
    </div>
</nav>


</main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
<ul class="social-links">
    <li><a href="https://github.com/wymli" target="_blank" title="github" data-toggle=tooltip data-placement=top >
            <i class="icon icon-github"></i></a></li>
    <li><a href="https://wymli.github.io/index.xml" target="_blank" title="rss" data-toggle=tooltip data-placement=top >
            <i class="icon icon-rss"></i></a></li>
</ul>
  <div class="copyright">
    &copy;2021  -
    2025
    <div class="publishby">
        Theme by <a href="https://github.com/xiaoheiAh" target="_blank"> xiaoheiAh </a>base on<a href="https://github.com/xiaoheiAh/hugo-theme-pure" target="_blank"> pure</a>.
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>
    window.jQuery || document.write('\x3Cscript src="js/jquery.min.js"><\/script>')
</script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/highlight.min.js"></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/python.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/javascript.min.js" defer></script>
<script type="text/javascript" src="https://cdn.staticfile.org/highlight.js/9.15.10/languages/go.min.js" defer></script><script>
    hljs.configure({
        tabReplace: '    ', 
        classPrefix: ''     
        
    })
    hljs.initHighlightingOnLoad();
</script>
<script src="https://wymli.github.io/js/application.min.e4989ab4dc212027af8773861b05b6bc333a1217f6b0a1b3377a3a3dbd454483.js"></script>
<script src="https://wymli.github.io/js/plugin.min.353ef3573cf0beb9b69d43450140ff59f497f732396f539052fc4973c6330fdb.js"></script>

<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Pages',
                CATEGORIES: 'Categories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            ROOT_URL: 'https:\/\/wymli.github.io\/',
            CONTENT_URL: 'https:\/\/wymli.github.io\/\/searchindex.json ',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script type="text/javascript" src="https://wymli.github.io/js/insight.min.716b0c6a00b68ccc31a2b65345f3412f4246ffa94a90f8e25d525528b4504f9937880692bbe619023233caba5d0a17ebe23d7cfb57cd3a88f23ea337ad5e4d00.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3',
        
        hasInnerContainers: true,
    });
</script>



  </body>
</html>
